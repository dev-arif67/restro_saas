import{i as S,a as w,r as x,R as C,j as e,L as F,z as y,D as R,C as N}from"./index-DOj4cv-Y.js";import{u as P}from"./useQuery-v6eG86EQ.js";import{u as k}from"./useMutation-CzbCp_v3.js";import{y as B,B as E,C as L}from"./index-BdfqSiwZ.js";import"./iconBase-um1MA9Tc.js";const A="/storage/";function v({label:d,currentImage:p,fieldName:l,onFileSelect:o,onRemove:h}){const i=x.useRef(null),[f,c]=x.useState(null),m=n=>{const r=n.target.files[0];r&&(c(URL.createObjectURL(r)),o(l,r))},u=f||(p?A+p:null);return e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:d}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-24 h-24 rounded-xl border-2 border-dashed border-gray-300 flex items-center justify-center overflow-hidden bg-gray-50",children:u?e.jsx("img",{src:u,alt:d,className:"w-full h-full object-contain"}):e.jsx(B,{className:"w-8 h-8 text-gray-400"})}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("button",{type:"button",onClick:()=>{var n;return(n=i.current)==null?void 0:n.click()},className:"inline-flex items-center gap-1 px-3 py-1.5 text-sm bg-blue-50 text-blue-700 rounded-lg hover:bg-blue-100",children:[e.jsx(E,{className:"w-4 h-4"})," Upload"]}),u&&e.jsxs("button",{type:"button",onClick:()=>{c(null),h(l)},className:"inline-flex items-center gap-1 px-3 py-1.5 text-sm text-red-600 bg-red-50 rounded-lg hover:bg-red-100",children:[e.jsx(L,{className:"w-4 h-4"})," Remove"]})]})]}),e.jsx("input",{ref:i,type:"file",accept:"image/*",className:"hidden",onChange:m})]})}function D(){const d=S(),{setBranding:p}=w(),[l,o]=x.useState({}),[h,i]=x.useState({}),[f,c]=x.useState({}),{data:m,isLoading:u}=P({queryKey:["admin-settings"],queryFn:()=>N.settings.get().then(a=>a.data.data),onSuccess:a=>o(a||{})});C.useEffect(()=>{m&&Object.keys(l).length===0&&o(m)},[m]);const n=k({mutationFn:a=>N.settings.update(a),onSuccess:()=>{d.invalidateQueries(["admin-settings"]),d.invalidateQueries(["platform-branding"]),i({}),c({}),R.branding().then(a=>{const s=a.data.data;if(p(s),s.platform_name&&(document.title=s.platform_name),s.platform_favicon){let t=document.querySelector("link[rel~='icon']");t||(t=document.createElement("link"),t.rel="icon",document.head.appendChild(t)),t.href="/storage/"+s.platform_favicon}}),y.success("Platform branding updated!")},onError:a=>{var s,t;return y.error(((t=(s=a.response)==null?void 0:s.data)==null?void 0:t.message)||"Failed to update")}}),r=(a,s)=>{o(t=>({...t,[a]:s}))},b=(a,s)=>{i(t=>({...t,[a]:s})),c(t=>{const g={...t};return delete g[a],g})},j=a=>{c(s=>({...s,[a]:!0})),i(s=>{const t={...s};return delete t[a],t}),o(s=>({...s,[a]:null}))},_=a=>{a.preventDefault();const s=new FormData;["platform_name","primary_color","secondary_color","footer_text","powered_by_text","powered_by_url"].forEach(t=>{l[t]!==void 0&&l[t]!==null&&s.append(t,l[t])}),Object.entries(h).forEach(([t,g])=>{s.append(t,g)}),Object.keys(f).forEach(t=>{s.append(`remove_${t}`,"1")}),n.mutate(s)};return u?e.jsx(F,{}):e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-6",children:"Platform Settings"}),e.jsxs("form",{onSubmit:_,className:"space-y-8",children:[e.jsxs("div",{className:"card",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Platform Logo & Favicon"}),e.jsx("p",{className:"text-sm text-gray-500 mb-6",children:'These appear on the admin dashboard sidebar, login page, and as a small "powered by" branding on restaurant & customer panels.'}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx(v,{label:"Logo (Light Background)",currentImage:l.platform_logo,fieldName:"platform_logo",onFileSelect:b,onRemove:j}),e.jsx(v,{label:"Logo (Dark Background)",currentImage:l.platform_logo_dark,fieldName:"platform_logo_dark",onFileSelect:b,onRemove:j}),e.jsx(v,{label:"Favicon",currentImage:l.platform_favicon,fieldName:"platform_favicon",onFileSelect:b,onRemove:j})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Platform Info"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Platform Name"}),e.jsx("input",{className:"input",value:l.platform_name||"",onChange:a=>r("platform_name",a.target.value),placeholder:"RestaurantSaaS"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Footer Text"}),e.jsx("input",{className:"input",value:l.footer_text||"",onChange:a=>r("footer_text",a.target.value),placeholder:"Â© 2026 RestaurantSaaS. All rights reserved."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:'"Powered By" Text'}),e.jsx("input",{className:"input",value:l.powered_by_text||"",onChange:a=>r("powered_by_text",a.target.value),placeholder:"Powered by RestaurantSaaS"}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Shown on restaurant & customer panels"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:'"Powered By" URL'}),e.jsx("input",{className:"input",value:l.powered_by_url||"",onChange:a=>r("powered_by_url",a.target.value),placeholder:"https://yourwebsite.com"})]})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Brand Colors"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Primary Color"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"color",value:l.primary_color||"#3B82F6",onChange:a=>r("primary_color",a.target.value),className:"w-12 h-10 rounded border cursor-pointer"}),e.jsx("input",{className:"input flex-1",value:l.primary_color||"#3B82F6",onChange:a=>r("primary_color",a.target.value),placeholder:"#3B82F6"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Secondary Color"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"color",value:l.secondary_color||"#1E40AF",onChange:a=>r("secondary_color",a.target.value),className:"w-12 h-10 rounded border cursor-pointer"}),e.jsx("input",{className:"input flex-1",value:l.secondary_color||"#1E40AF",onChange:a=>r("secondary_color",a.target.value),placeholder:"#1E40AF"})]})]})]}),e.jsxs("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-500 mb-3",children:"Live Preview:"}),e.jsxs("div",{className:"flex gap-4 items-center",children:[e.jsx("div",{className:"h-10 px-6 rounded-lg flex items-center justify-center text-white text-sm font-medium",style:{backgroundColor:l.primary_color||"#3B82F6"},children:"Primary Button"}),e.jsx("div",{className:"h-10 px-6 rounded-lg flex items-center justify-center text-white text-sm font-medium",style:{backgroundColor:l.secondary_color||"#1E40AF"},children:"Secondary"})]})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{type:"submit",disabled:n.isPending,className:"btn-primary px-8",children:n.isPending?"Saving...":"Save Changes"})})]})]})}export{D as default};
