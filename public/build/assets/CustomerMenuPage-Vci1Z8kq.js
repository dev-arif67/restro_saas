import{d as q,e as I,A as L,r as b,j as e,L as F,f as P,z as A,g as O}from"./index-CGzGCCal.js";import{u as T}from"./useQuery-B-VUE0ak.js";import{u as j}from"./cartStore-DaVEQcoT.js";import{E as N,e as $,r as E}from"./index-BX6eEVf5.js";import"./iconBase-Bj3tzzhS.js";function R(){var y;const{slug:i}=q(),[w]=I(),{restaurant:c}=L()||{},[r,h]=b.useState(null),[l,f]=b.useState(""),{addItem:v,updateQty:C,items:d}=j(),a=(c==null?void 0:c.primary_color)||"#3B82F6",{data:x,isLoading:k}=T({queryKey:["customer-menu",i],queryFn:()=>O.menu(i).then(s=>s.data.data)}),S=s=>{const t=d.find(n=>n.menu_item_id===s.id);t?C(s.id,t.qty+1):v(s),A.success(`${s.name} added`,{duration:1200,icon:"ðŸ›’",style:{fontSize:"14px"}})};if(k)return e.jsx(F,{});const m=(x==null?void 0:x.categories)||[],p=m.flatMap(s=>s.menu_items||[]),g=r?((y=m.find(s=>s.id===r))==null?void 0:y.menu_items)||[]:p,u=l?g.filter(s=>s.name.toLowerCase().includes(l.toLowerCase())):g,o=d.reduce((s,t)=>s+t.qty,0),_=j.getState().getSubtotal();return e.jsxs("div",{className:"pb-28",children:[e.jsx("div",{className:"sticky top-[60px] z-30 bg-gray-50 px-3 pt-3 pb-2",children:e.jsxs("div",{className:"relative",children:[e.jsx(N,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:"text",className:"w-full pl-10 pr-10 py-3 rounded-xl border border-gray-200 bg-white focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20 outline-none text-sm shadow-sm",placeholder:"Search menu items...",value:l,onChange:s=>f(s.target.value)}),l&&e.jsx("button",{onClick:()=>f(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:e.jsx($,{className:"w-5 h-5"})})]})}),e.jsx("div",{className:"sticky top-[120px] z-20 bg-gray-50 px-3 pb-2",children:e.jsxs("div",{className:"flex gap-2 overflow-x-auto pb-1 scrollbar-hide -mx-1 px-1",children:[e.jsxs("button",{onClick:()=>h(null),className:"px-4 py-2 rounded-full text-xs font-semibold whitespace-nowrap transition-all shadow-sm",style:r?{backgroundColor:"#f3f4f6",color:"#4b5563"}:{backgroundColor:a,color:"#fff"},children:["All (",p.length,")"]}),m.map(s=>{var t;return e.jsxs("button",{onClick:()=>h(s.id),className:"px-4 py-2 rounded-full text-xs font-semibold whitespace-nowrap transition-all shadow-sm",style:r===s.id?{backgroundColor:a,color:"#fff"}:{backgroundColor:"#f3f4f6",color:"#4b5563"},children:[s.name," (",((t=s.menu_items)==null?void 0:t.length)||0,")"]},s.id)})]})}),l&&e.jsx("div",{className:"px-3 pt-1 pb-2",children:e.jsxs("p",{className:"text-xs text-gray-500",children:[u.length,' items found for "',l,'"']})}),e.jsx("div",{className:"px-3 pt-1",children:u.length===0?e.jsxs("div",{className:"text-center py-16",children:[e.jsx(N,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-400 font-medium",children:"No items found"}),e.jsx("p",{className:"text-gray-300 text-sm mt-1",children:"Try a different search term"})]}):e.jsx("div",{className:"grid grid-cols-2 gap-3",children:u.map(s=>{const t=d.find(z=>z.menu_item_id===s.id),n=s.image_url||(s.image?`/storage/${s.image}`:null);return e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden flex flex-col transition-transform active:scale-[0.98]",children:[n?e.jsxs("div",{className:"w-full aspect-[4/3] bg-gray-100 relative overflow-hidden",children:[e.jsx("img",{src:n,alt:s.name,className:"w-full h-full object-cover",loading:"lazy"}),t&&e.jsx("div",{className:"absolute top-2 right-2 w-6 h-6 rounded-full text-white text-xs font-bold flex items-center justify-center shadow-md",style:{backgroundColor:a},children:t.qty})]}):e.jsxs("div",{className:"w-full aspect-[4/3] bg-gradient-to-br from-gray-50 to-gray-100 flex items-center justify-center relative",children:[e.jsx("span",{className:"text-3xl",children:"ðŸ½ï¸"}),t&&e.jsx("div",{className:"absolute top-2 right-2 w-6 h-6 rounded-full text-white text-xs font-bold flex items-center justify-center shadow-md",style:{backgroundColor:a},children:t.qty})]}),e.jsxs("div",{className:"p-3 flex flex-col flex-1",children:[e.jsx("h3",{className:"font-semibold text-gray-900 text-sm leading-tight line-clamp-2",children:s.name}),s.description&&e.jsx("p",{className:"text-xs text-gray-400 mt-1 line-clamp-1",children:s.description}),e.jsxs("div",{className:"mt-auto pt-2 flex items-center justify-between",children:[e.jsxs("p",{className:"text-base font-bold",style:{color:a},children:["à§³",parseFloat(s.price).toFixed(0)]}),e.jsx("button",{onClick:()=>S(s),className:"w-8 h-8 rounded-full text-white flex items-center justify-center text-lg shadow-md transition-all active:scale-90 hover:shadow-lg",style:{backgroundColor:a},children:"+"})]})]})]},s.id)})})}),o>0&&e.jsx("div",{className:"fixed bottom-4 left-3 right-3 max-w-lg mx-auto z-50",children:e.jsxs(P,{to:`/restaurant/${i}/cart?${w.toString()}`,className:"flex items-center justify-between rounded-2xl py-3.5 px-5 shadow-xl text-white transition-all active:scale-[0.98]",style:{backgroundColor:a},children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx(E,{className:"w-5 h-5"}),e.jsx("span",{className:"absolute -top-1.5 -right-1.5 w-4 h-4 bg-white rounded-full text-[10px] font-bold flex items-center justify-center",style:{color:a},children:o})]}),e.jsxs("span",{className:"font-medium text-sm",children:[o," ",o===1?"item":"items"]})]}),e.jsx("span",{className:"font-bold text-sm",children:"View Cart"}),e.jsxs("span",{className:"font-bold text-sm",children:["à§³",_.toFixed(0)]})]})})]})}export{R as default};
