import{i as j,r as b,j as e,L as N,z as r,B as m}from"./index-VcNFqetI.js";import{u as y}from"./useQuery-Rt3S72ZS.js";import{u as o}from"./useMutation-C8vzS0_Q.js";import{S as x}from"./StatusBadge-DtDva7gu.js";import{M as v}from"./Modal-DG5C7CFd.js";function S(){const c=j(),[u,n]=b.useState(!1),{data:i,isLoading:p}=y({queryKey:["admin-tenants"],queryFn:()=>m.tenants.list().then(s=>s.data.data)}),l=o({mutationFn:s=>m.tenants.create(s),onSuccess:()=>{c.invalidateQueries(["admin-tenants"]),n(!1),r.success("Tenant onboarded!")},onError:s=>{var a,t;return r.error(((t=(a=s.response)==null?void 0:a.data)==null?void 0:t.message)||"Error")}}),d=o({mutationFn:({id:s,is_active:a})=>m.tenants.update(s,{is_active:a}),onSuccess:()=>{c.invalidateQueries(["admin-tenants"]),r.success("Updated")}}),h=s=>{s.preventDefault();const a=Object.fromEntries(new FormData(s.target)),t={name:a.name,email:a.email,phone:a.phone||null,payment_mode:a.payment_mode,commission_rate:parseFloat(a.commission_rate||5),admin_name:a.admin_name,admin_email:a.admin_email,admin_password:a.admin_password,plan_type:a.plan_type,subscription_amount:parseFloat(a.subscription_amount||0),payment_method:a.payment_method||"manual"};l.mutate(t)};return p?e.jsx(N,{}):e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-gray-800",children:"Tenants"}),e.jsx("button",{onClick:()=>n(!0),className:"btn-primary text-sm sm:text-base",children:"+ Onboard"})]}),e.jsx("div",{className:"hidden md:block card overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left border-b",children:[e.jsx("th",{className:"pb-3",children:"Name"}),e.jsx("th",{className:"pb-3",children:"Slug"}),e.jsx("th",{className:"pb-3",children:"Email"}),e.jsx("th",{className:"pb-3",children:"Payment"}),e.jsx("th",{className:"pb-3",children:"Commission"}),e.jsx("th",{className:"pb-3",children:"Status"}),e.jsx("th",{className:"pb-3"})]})}),e.jsx("tbody",{children:i==null?void 0:i.map(s=>e.jsxs("tr",{className:"border-b last:border-0",children:[e.jsx("td",{className:"py-3 font-medium",children:s.name}),e.jsx("td",{className:"py-3 font-mono text-sm",children:s.slug}),e.jsx("td",{className:"py-3",children:s.email}),e.jsx("td",{className:"py-3 capitalize",children:s.payment_mode}),e.jsxs("td",{className:"py-3",children:[s.commission_rate,"%"]}),e.jsx("td",{className:"py-3",children:e.jsx(x,{status:s.is_active?"active":"inactive"})}),e.jsx("td",{className:"py-3",children:e.jsx("button",{onClick:()=>d.mutate({id:s.id,is_active:!s.is_active}),className:`text-sm ${s.is_active?"text-red-600":"text-green-600"}`,children:s.is_active?"Deactivate":"Activate"})})]},s.id))})]})}),e.jsx("div",{className:"md:hidden space-y-3",children:i==null?void 0:i.map(s=>e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2 mb-2",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"font-semibold text-gray-900 truncate",children:s.name}),e.jsx("p",{className:"text-xs text-gray-500 font-mono",children:s.slug})]}),e.jsx(x,{status:s.is_active?"active":"inactive"})]}),e.jsx("p",{className:"text-sm text-gray-500 truncate",children:s.email}),e.jsxs("div",{className:"flex items-center justify-between mt-3 pt-3 border-t text-sm",children:[e.jsxs("div",{className:"flex gap-3 text-gray-500",children:[e.jsx("span",{className:"capitalize",children:s.payment_mode}),e.jsxs("span",{children:[s.commission_rate,"%"]})]}),e.jsx("button",{onClick:()=>d.mutate({id:s.id,is_active:!s.is_active}),className:`text-sm font-medium ${s.is_active?"text-red-600":"text-green-600"}`,children:s.is_active?"Deactivate":"Activate"})]})]},s.id))}),e.jsx(v,{isOpen:u,onClose:()=>n(!1),title:"Onboard Tenant",size:"lg",children:e.jsxs("form",{onSubmit:h,className:"space-y-4",children:[e.jsx("h4",{className:"font-medium text-gray-700",children:"Restaurant Info"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Restaurant Name"}),e.jsx("input",{name:"name",className:"input",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Email"}),e.jsx("input",{name:"email",type:"email",className:"input",required:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Phone"}),e.jsx("input",{name:"phone",className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Payment Mode"}),e.jsxs("select",{name:"payment_mode",className:"input",children:[e.jsx("option",{value:"seller",children:"Seller Collects"}),e.jsx("option",{value:"platform",children:"Platform Collects"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Commission %"}),e.jsx("input",{name:"commission_rate",type:"number",step:"0.01",className:"input",defaultValue:"5"})]}),e.jsx("hr",{}),e.jsx("h4",{className:"font-medium text-gray-700",children:"Admin User"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Admin Name"}),e.jsx("input",{name:"admin_name",className:"input",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Admin Email"}),e.jsx("input",{name:"admin_email",type:"email",className:"input",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Admin Password"}),e.jsx("input",{name:"admin_password",type:"password",className:"input",required:!0,minLength:8})]}),e.jsx("hr",{}),e.jsx("h4",{className:"font-medium text-gray-700",children:"Subscription"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Plan"}),e.jsxs("select",{name:"plan_type",className:"input",children:[e.jsx("option",{value:"monthly",children:"Monthly"}),e.jsx("option",{value:"yearly",children:"Yearly"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Amount"}),e.jsx("input",{name:"subscription_amount",type:"number",className:"input",required:!0})]})]}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx("button",{type:"submit",className:"btn-primary",disabled:l.isPending,children:l.isPending?"Creating...":"Onboard"}),e.jsx("button",{type:"button",onClick:()=>n(!1),className:"btn-secondary",children:"Cancel"})]})]})})]})}export{S as default};
