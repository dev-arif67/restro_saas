import{d as N,e as v,a as w,r as l,R as k,j as e,L as S,f as R,O,g as T}from"./index-C-fHFgbm.js";import{u as C}from"./useQuery-BCRd2gHe.js";import{u as L}from"./cartStore-CBXpVBm4.js";import{P as I}from"./PoweredBy-B1RzqvyF.js";import{x as P}from"./index-CmYeZnUY.js";import"./iconBase-b9VFOml0.js";function _(r){try{const n=`recent_orders_${r}`;return JSON.parse(localStorage.getItem(n)||"[]")}catch{return[]}}function A(){var u;const{slug:r}=N(),[n]=v(),{setTenantId:q,setTableId:h,setOrderType:f}=L(),{branding:g}=w(),p=l.useRef(document.title),d=l.useRef((u=document.querySelector("link[rel~='icon']"))==null?void 0:u.href),[m,c]=l.useState(!1),a=n.get("table"),i=n.get("type")||(a?"dine":"parcel"),x=_(r);k.useEffect(()=>{a&&h(parseInt(a)),f(i)},[r,a,i]);const{data:t,isLoading:y,error:j}=C({queryKey:["restaurant",r],queryFn:()=>T.restaurant(r).then(s=>s.data.data)}),o=(t==null?void 0:t.primary_color)||"#3B82F6";return l.useEffect(()=>{if(t&&(t.name&&(document.title=t.name),t.favicon)){let s=document.querySelector("link[rel~='icon']");s||(s=document.createElement("link"),s.rel="icon",document.head.appendChild(s)),s.href="/storage/"+t.favicon}return()=>{document.title=p.current||g.platform_name||"RestaurantSaaS";const s=document.querySelector("link[rel~='icon']");s&&d.current&&(s.href=d.current)}},[t]),y?e.jsx(S,{fullScreen:!0}):j?e.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-50 px-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-5xl mb-4",children:"ðŸ½ï¸"}),e.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-2",children:"Restaurant Unavailable"}),e.jsx("p",{className:"text-gray-500 text-sm",children:"This restaurant is currently not accepting orders."})]})}):e.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[e.jsx("header",{className:"bg-white shadow-sm sticky top-0 z-40",style:{borderBottom:`3px solid ${o}`},children:e.jsxs("div",{className:"max-w-lg mx-auto px-4 py-3 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center min-w-0",children:[(t==null?void 0:t.logo)&&e.jsx("img",{src:`/storage/${t.logo}`,alt:"",className:"w-8 h-8 rounded-full mr-3 object-cover flex-shrink-0"}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h1",{className:"text-base font-bold text-gray-900 truncate",children:t==null?void 0:t.name}),a?e.jsxs("p",{className:"text-xs text-gray-500",children:["Table ",a," Â· Dine-in"]}):e.jsx("p",{className:"text-xs text-gray-500",children:"Takeaway Order"})]})]}),x.length>0&&e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>c(!m),className:"p-2 rounded-full hover:bg-gray-100 transition relative",title:"Recent orders",children:[e.jsx(P,{className:"w-5 h-5 text-gray-600"}),e.jsx("span",{className:"absolute top-1 right-1 w-2 h-2 rounded-full",style:{backgroundColor:o}})]}),m&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>c(!1)}),e.jsxs("div",{className:"absolute right-0 top-full mt-2 w-64 bg-white rounded-2xl shadow-xl border border-gray-100 z-50 overflow-hidden",children:[e.jsx("div",{className:"p-3 border-b border-gray-100",children:e.jsx("p",{className:"text-xs font-semibold text-gray-500 uppercase",children:"Recent Orders"})}),e.jsx("div",{className:"max-h-64 overflow-y-auto",children:x.slice(0,5).map((s,b)=>e.jsxs(R,{to:`/order/${s.orderNumber}`,onClick:()=>c(!1),className:"flex items-center justify-between px-3 py-2.5 hover:bg-gray-50 transition",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-medium text-gray-800",children:["#",s.orderNumber]}),e.jsxs("p",{className:"text-[11px] text-gray-400",children:[new Date(s.placedAt).toLocaleDateString()," ",new Date(s.placedAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]})]}),e.jsx("span",{className:"text-xs font-medium",style:{color:o},children:"Track â†’"})]},b))})]})]})]})]})}),(t==null?void 0:t.banner_image)&&e.jsx("div",{className:"max-w-lg mx-auto w-full",children:e.jsx("img",{src:`/storage/${t.banner_image}`,alt:"",className:"w-full h-36 object-cover"})}),e.jsx("div",{className:"max-w-lg mx-auto flex-1 w-full",children:e.jsx(O,{context:{restaurant:t,slug:r,tableId:a,orderType:i}})}),e.jsx("footer",{className:"py-4 text-center",children:e.jsx(I,{})})]})}export{A as default};
