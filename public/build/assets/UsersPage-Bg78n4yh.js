import{i as b,r as m,j as e,L as f,z as o,n as c}from"./index-DOj4cv-Y.js";import{u as N}from"./useQuery-v6eG86EQ.js";import{u as y}from"./useMutation-CzbCp_v3.js";import{M as v}from"./Modal-ZeGiXP6Y.js";import{S as x}from"./StatusBadge-BDL9JjHF.js";function k(){const u=b(),[h,l]=m.useState(!1),[a,i]=m.useState(null),{data:r,isLoading:j}=N({queryKey:["users"],queryFn:()=>c.list().then(s=>s.data.data)}),d=y({mutationFn:s=>a?c.update(a.id,s):c.create(s),onSuccess:()=>{u.invalidateQueries(["users"]),l(!1),i(null),o.success(a?"Updated":"Created")},onError:s=>{var t,n;return o.error(((n=(t=s.response)==null?void 0:t.data)==null?void 0:n.message)||"Error")}}),p=s=>{s.preventDefault();const t=Object.fromEntries(new FormData(s.target));!t.password&&a&&delete t.password,d.mutate(t)};return j?e.jsx(f,{}):e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-gray-800",children:"Team Members"}),e.jsx("button",{onClick:()=>{i(null),l(!0)},className:"btn-primary text-sm sm:text-base",children:"+ Add User"})]}),e.jsx("div",{className:"hidden md:block card overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left border-b",children:[e.jsx("th",{className:"pb-3",children:"Name"}),e.jsx("th",{className:"pb-3",children:"Email"}),e.jsx("th",{className:"pb-3",children:"Role"}),e.jsx("th",{className:"pb-3",children:"Status"}),e.jsx("th",{className:"pb-3"})]})}),e.jsx("tbody",{children:r==null?void 0:r.map(s=>e.jsxs("tr",{className:"border-b last:border-0",children:[e.jsx("td",{className:"py-3 font-medium",children:s.name}),e.jsx("td",{className:"py-3",children:s.email}),e.jsx("td",{className:"py-3 capitalize",children:s.role.replace("_"," ")}),e.jsx("td",{className:"py-3",children:e.jsx(x,{status:s.status})}),e.jsx("td",{className:"py-3",children:e.jsx("button",{onClick:()=>{i(s),l(!0)},className:"text-blue-600 text-sm",children:"Edit"})})]},s.id))})]})}),e.jsx("div",{className:"md:hidden space-y-3",children:r==null?void 0:r.map(s=>{var t,n;return e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[e.jsx("div",{className:"w-9 h-9 bg-blue-600 rounded-full flex items-center justify-center text-white text-sm font-medium shrink-0",children:(n=(t=s.name)==null?void 0:t[0])==null?void 0:n.toUpperCase()}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"font-medium text-gray-900 truncate",children:s.name}),e.jsx("p",{className:"text-sm text-gray-500 truncate",children:s.email})]})]}),e.jsx(x,{status:s.status})]}),e.jsxs("div",{className:"flex items-center justify-between mt-3 pt-3 border-t",children:[e.jsx("span",{className:"text-sm text-gray-500 capitalize",children:s.role.replace("_"," ")}),e.jsx("button",{onClick:()=>{i(s),l(!0)},className:"text-blue-600 text-sm font-medium",children:"Edit"})]})]},s.id)})}),e.jsx(v,{isOpen:h,onClose:()=>l(!1),title:a?"Edit User":"Add User",children:e.jsxs("form",{onSubmit:p,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Name"}),e.jsx("input",{name:"name",className:"input",defaultValue:a==null?void 0:a.name,required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Email"}),e.jsx("input",{name:"email",type:"email",className:"input",defaultValue:a==null?void 0:a.email,required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"label",children:["Password ",a&&"(leave blank to keep)"]}),e.jsx("input",{name:"password",type:"password",className:"input",...!a&&{required:!0},minLength:8})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Role"}),e.jsxs("select",{name:"role",className:"input",defaultValue:(a==null?void 0:a.role)||"staff",children:[e.jsx("option",{value:"restaurant_admin",children:"Restaurant Admin"}),e.jsx("option",{value:"staff",children:"Staff / Waiter"}),e.jsx("option",{value:"kitchen",children:"Kitchen"})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{type:"submit",className:"btn-primary",disabled:d.isPending,children:"Save"}),e.jsx("button",{type:"button",onClick:()=>l(!1),className:"btn-secondary",children:"Cancel"})]})]})})]})}export{k as default};
