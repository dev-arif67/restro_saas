import{r as I,j as n}from"./index-CanGr6k3.js";import{O as D}from"./index-c6C0Wc7z.js";function E({data:o,order:s,restaurant:F,onClose:r}){var k;const j=I.useRef(null),p=(o==null?void 0:o.invoice)??null,t=(o==null?void 0:o.restaurant)??F??null,P=(o==null?void 0:o.items)??(s==null?void 0:s.items)??[],i=(o==null?void 0:o.totals)??null,d=(o==null?void 0:o.payment)??null,m=(p==null?void 0:p.order_number)??(s==null?void 0:s.order_number),v=(p==null?void 0:p.invoice_number)??(s==null?void 0:s.invoice_number)??null,w=(p==null?void 0:p.date)??(s==null?void 0:s.created_at),a=(s==null?void 0:s.type)??"",N=((k=s==null?void 0:s.table)==null?void 0:k.table_number)??null,h=(s==null?void 0:s.customer_name)??null,f=(s==null?void 0:s.customer_phone)??null,T=parseFloat((i==null?void 0:i.subtotal)??(s==null?void 0:s.subtotal)??0),u=parseFloat((i==null?void 0:i.discount)??(s==null?void 0:s.discount)??0),b=parseFloat((i==null?void 0:i.net_amount)??(s==null?void 0:s.net_amount)??0),A=parseFloat((i==null?void 0:i.vat_rate)??(s==null?void 0:s.vat_rate)??0),z=parseFloat((i==null?void 0:i.vat_amount)??(s==null?void 0:s.vat_amount)??(s==null?void 0:s.tax)??0),_=parseFloat((i==null?void 0:i.grand_total)??(s==null?void 0:s.grand_total)??0),x=(d==null?void 0:d.method)??(s==null?void 0:s.payment_method)??"",c=((d==null?void 0:d.status)??(s==null?void 0:s.payment_status)??"")==="paid",S=(s==null?void 0:s.transaction_id)??null,W={cash:"Cash",card:"Card / POS",mobile_banking:"Mobile Banking",online:"Online"}[x]??x,g=()=>{const e=j.current;if(!e)return;const l=window.open("","_blank","width=320,height=600");l.document.write(`
            <!DOCTYPE html>
            <html>
            <head>
                <meta charset="utf-8" />
                <title>Invoice - ${m}</title>
                <style>
                    * { margin: 0; padding: 0; box-sizing: border-box; }
                    body { font-family: 'Courier New', monospace; font-size: 12px; color: #000; width: 80mm; margin: 0 auto; padding: 8px; }
                    .center { text-align: center; }
                    .bold { font-weight: bold; }
                    .divider { border-top: 1px dashed #000; margin: 6px 0; }
                    .row { display: flex; justify-content: space-between; padding: 1px 0; }
                    .item-row { display: flex; justify-content: space-between; padding: 2px 0; }
                    .restaurant-name { font-size: 16px; font-weight: bold; }
                    .order-num { font-size: 14px; font-weight: bold; margin: 4px 0; }
                    .inv-num { font-size: 11px; color: #444; margin-bottom: 2px; }
                    .total-row { font-size: 14px; font-weight: bold; }
                    .footer { font-size: 10px; color: #666; margin-top: 8px; }
                    .badge { display: inline-block; padding: 2px 8px; border-radius: 4px; font-size: 10px; font-weight: bold; text-transform: uppercase; }
                    .badge-paid { background: #dcfce7; color: #166534; }
                    .badge-pending { background: #fef3c7; color: #92400e; }
                    .badge-cash { background: #e0f2fe; color: #075985; }
                    .badge-online { background: #f3e8ff; color: #6b21a8; }
                    @media print {
                        body { width: 80mm; }
                        @page { size: 80mm auto; margin: 0; }
                    }
                </style>
            </head>
            <body>
                ${e.innerHTML}
            </body>
            </html>
        `),l.document.close(),l.focus(),setTimeout(()=>{l.print(),l.close()},250)};return m?n.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4",onClick:r,children:n.jsxs("div",{className:"bg-white rounded-2xl max-w-sm w-full max-h-[90vh] overflow-y-auto shadow-2xl",onClick:e=>e.stopPropagation(),children:[n.jsxs("div",{className:"flex items-center justify-between p-4 border-b bg-gray-50 rounded-t-2xl",children:[n.jsx("h3",{className:"font-bold text-gray-800",children:"Invoice"}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs("button",{onClick:g,className:"flex items-center gap-1 px-3 py-1.5 text-sm bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[n.jsx(D,{className:"w-4 h-4"})," Print"]}),n.jsx("button",{onClick:r,className:"px-3 py-1.5 text-sm bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300",children:"Close"})]})]}),n.jsxs("div",{ref:j,className:"p-5",children:[n.jsxs("div",{className:"center",style:{textAlign:"center"},children:[(t==null?void 0:t.logo)&&n.jsx("img",{src:`/storage/${t.logo}`,alt:"",style:{height:"40px",margin:"0 auto 6px"}}),n.jsx("div",{className:"restaurant-name",style:{fontSize:"16px",fontWeight:"bold"},children:(t==null?void 0:t.name)||"Restaurant"}),(t==null?void 0:t.address)&&n.jsx("div",{style:{fontSize:"11px",color:"#666",marginTop:"2px"},children:t.address}),(t==null?void 0:t.phone)&&n.jsxs("div",{style:{fontSize:"11px",color:"#666"},children:["Tel: ",t.phone]}),(t==null?void 0:t.vat_number)&&n.jsxs("div",{style:{fontSize:"11px",color:"#444",marginTop:"2px",fontWeight:"bold"},children:["BIN/VAT: ",t.vat_number]})]}),n.jsx("div",{className:"divider",style:{borderTop:"1px dashed #000",margin:"8px 0"}}),n.jsxs("div",{style:{textAlign:"center"},children:[v&&n.jsxs("div",{className:"inv-num",style:{fontSize:"11px",color:"#444",marginBottom:"2px"},children:["Invoice: ",v]}),n.jsx("div",{className:"order-num",style:{fontSize:"14px",fontWeight:"bold"},children:m}),n.jsxs("div",{style:{fontSize:"11px",color:"#666",display:"flex",justifyContent:"center",gap:"8px",flexWrap:"wrap",marginTop:"4px"},children:[a&&n.jsx("span",{style:{textTransform:"capitalize"},children:a==="dine"?"Dine-in":a==="parcel"?"Takeaway":a}),N&&n.jsxs("span",{children:["| Table ",N]}),w&&n.jsxs("span",{children:["| ",new Date(w).toLocaleString()]})]})]}),n.jsx("div",{className:"divider",style:{borderTop:"1px dashed #000",margin:"8px 0"}}),(h||f)&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{style:{fontSize:"11px"},children:[h&&n.jsxs("div",{children:["Customer: ",h]}),f&&n.jsxs("div",{children:["Phone: ",f]})]}),n.jsx("div",{className:"divider",style:{borderTop:"1px dashed #000",margin:"8px 0"}})]}),n.jsxs("div",{children:[n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontWeight:"bold",fontSize:"11px",marginBottom:"4px"},children:[n.jsx("span",{children:"Item"}),n.jsx("span",{children:"Total"})]}),P.map((e,l)=>{var C;return n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"2px 0",fontSize:"12px"},children:[n.jsxs("span",{children:[e.qty,"x ",e.name??((C=e.menu_item)==null?void 0:C.name)??"Item"]}),n.jsxs("span",{children:["৳",parseFloat(e.line_total??e.unit_price*e.qty).toFixed(2)]})]},e.id??l)})]}),n.jsx("div",{className:"divider",style:{borderTop:"1px dashed #000",margin:"8px 0"}}),n.jsxs("div",{style:{fontSize:"12px"},children:[n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"1px 0"},children:[n.jsx("span",{children:"Subtotal"}),n.jsxs("span",{children:["৳",T.toFixed(2)]})]}),u>0&&n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"1px 0",color:"#16a34a"},children:[n.jsx("span",{children:"Discount"}),n.jsxs("span",{children:["-৳",u.toFixed(2)]})]}),b>0&&b!==T-u&&n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"1px 0"},children:[n.jsx("span",{children:"Net Amount"}),n.jsxs("span",{children:["৳",b.toFixed(2)]})]}),z>0&&n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"1px 0"},children:[n.jsxs("span",{children:["VAT (",A,"%)"]}),n.jsxs("span",{children:["৳",z.toFixed(2)]})]}),n.jsx("div",{className:"divider",style:{borderTop:"1px dashed #000",margin:"6px 0"}}),n.jsxs("div",{className:"total-row",style:{display:"flex",justifyContent:"space-between",fontSize:"15px",fontWeight:"bold"},children:[n.jsx("span",{children:"TOTAL"}),n.jsxs("span",{children:["৳",_.toFixed(2)]})]})]}),n.jsx("div",{className:"divider",style:{borderTop:"1px dashed #000",margin:"8px 0"}}),n.jsxs("div",{style:{textAlign:"center",fontSize:"12px"},children:[n.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:"6px",flexWrap:"wrap"},children:[x&&n.jsx("span",{style:{display:"inline-block",padding:"2px 8px",borderRadius:"4px",fontSize:"10px",fontWeight:"bold",textTransform:"uppercase",background:x==="cash"?"#e0f2fe":x==="card"?"#ede9fe":"#f0fdf4",color:x==="cash"?"#075985":x==="card"?"#5b21b6":"#166534"},children:W}),n.jsx("span",{style:{display:"inline-block",padding:"2px 8px",borderRadius:"4px",fontSize:"10px",fontWeight:"bold",textTransform:"uppercase",background:c?"#dcfce7":"#fef3c7",color:c?"#166534":"#92400e"},children:c?"PAID":"UNPAID"})]}),S&&n.jsxs("div",{style:{fontSize:"10px",color:"#666",marginTop:"4px"},children:["TXN: ",S]})]}),n.jsx("div",{className:"divider",style:{borderTop:"1px dashed #000",margin:"8px 0"}}),n.jsxs("div",{className:"footer",style:{textAlign:"center",fontSize:"10px",color:"#666",marginTop:"8px"},children:[n.jsx("p",{children:"Thank you for your order!"}),x==="cash"&&!c&&n.jsxs("p",{style:{marginTop:"4px",fontWeight:"bold",color:"#92400e"},children:["Please pay ৳",_.toFixed(2)," at the counter"]})]})]})]})}):null}export{E as P};
