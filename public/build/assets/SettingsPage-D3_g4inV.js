import{r as m,j as e,i as C,z as j,p as y,L as _,s as R}from"./index-DOj4cv-Y.js";import{u as w}from"./useQuery-v6eG86EQ.js";import{u as A}from"./useMutation-CzbCp_v3.js";import{y as B,B as V,C as E}from"./index-BdfqSiwZ.js";import"./iconBase-um1MA9Tc.js";const P="/storage/";function v({label:l,currentImage:s,fieldName:r,onFileSelect:d,onRemove:b,hint:u}){const x=m.useRef(null),[i,c]=m.useState(null),g=o=>{const h=o.target.files[0];h&&(c(URL.createObjectURL(h)),d(r,h))},p=i||(s?P+s:null);return e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:l}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-20 h-20 rounded-xl border-2 border-dashed border-gray-300 flex items-center justify-center overflow-hidden bg-gray-50",children:p?e.jsx("img",{src:p,alt:l,className:"w-full h-full object-contain"}):e.jsx(B,{className:"w-7 h-7 text-gray-400"})}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("button",{type:"button",onClick:()=>{var o;return(o=x.current)==null?void 0:o.click()},className:"inline-flex items-center gap-1 px-3 py-1.5 text-sm bg-blue-50 text-blue-700 rounded-lg hover:bg-blue-100",children:[e.jsx(V,{className:"w-4 h-4"})," Upload"]}),p&&e.jsxs("button",{type:"button",onClick:()=>{c(null),b(r)},className:"inline-flex items-center gap-1 px-3 py-1.5 text-sm text-red-600 bg-red-50 rounded-lg hover:bg-red-100",children:[e.jsx(E,{className:"w-4 h-4"})," Remove"]})]})]}),u&&e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:u}),e.jsx("input",{ref:x,type:"file",accept:"image/*",className:"hidden",onChange:g})]})}function I(){var S,k,F;const l=C(),[s,r]=m.useState({}),[d,b]=m.useState({}),[u,x]=m.useState({}),{data:i,isLoading:c}=w({queryKey:["tenant-branding"],queryFn:()=>y.get().then(a=>a.data.data)});m.useEffect(()=>{i&&Object.keys(s).length===0&&r(i)},[i]);const g=A({mutationFn:a=>y.update(a),onSuccess:()=>{l.invalidateQueries(["tenant-branding"]),b({}),x({}),j.success("Branding updated!")},onError:a=>{var n,t;return j.error(((t=(n=a.response)==null?void 0:n.data)==null?void 0:t.message)||"Failed to update")}}),p=(a,n)=>r(t=>({...t,[a]:n})),o=(a,n)=>{b(t=>({...t,[a]:n})),x(t=>{const f={...t};return delete f[a],f})},h=a=>{x(n=>({...n,[a]:!0})),b(n=>{const t={...n};return delete t[a],t}),r(n=>({...n,[a]:null}))},N=(a,n)=>{r(t=>({...t,social_links:{...t.social_links||{},[a]:n}}))},T=a=>{a.preventDefault();const n=new FormData;["name","description","primary_color","secondary_color","accent_color"].forEach(t=>{s[t]!==void 0&&s[t]!==null&&n.append(t,s[t])}),s.social_links&&Object.entries(s.social_links).forEach(([t,f])=>{n.append(`social_links[${t}]`,f||"")}),Object.entries(d).forEach(([t,f])=>n.append(t,f)),Object.keys(u).forEach(t=>n.append(`remove_${t}`,"1")),g.mutate(n)};return c?e.jsx(_,{}):e.jsxs("form",{onSubmit:T,className:"space-y-6",children:[e.jsxs("div",{className:"card",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Restaurant Logo & Images"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx(v,{label:"Logo",currentImage:s.logo,fieldName:"logo",onFileSelect:o,onRemove:h,hint:"Shown in header & customer menu"}),e.jsx(v,{label:"Logo (Dark)",currentImage:s.logo_dark,fieldName:"logo_dark",onFileSelect:o,onRemove:h,hint:"For dark backgrounds"}),e.jsx(v,{label:"Favicon",currentImage:s.favicon,fieldName:"favicon",onFileSelect:o,onRemove:h,hint:"Browser tab icon"}),e.jsx(v,{label:"Banner",currentImage:s.banner_image,fieldName:"banner_image",onFileSelect:o,onRemove:h,hint:"Customer menu page banner"})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Restaurant Info"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Restaurant Name"}),e.jsx("input",{className:"input",value:s.name||"",onChange:a=>p("name",a.target.value)})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"label",children:"Description"}),e.jsx("textarea",{className:"input",rows:3,value:s.description||"",onChange:a=>p("description",a.target.value),placeholder:"A short description of your restaurant..."})]})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Brand Colors"}),e.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"These colors are used on the customer ordering page."}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[{key:"primary_color",label:"Primary",default:"#3B82F6"},{key:"secondary_color",label:"Secondary",default:"#1E40AF"},{key:"accent_color",label:"Accent",default:"#F59E0B"}].map(a=>e.jsxs("div",{children:[e.jsxs("label",{className:"label",children:[a.label," Color"]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"color",value:s[a.key]||a.default,onChange:n=>p(a.key,n.target.value),className:"w-12 h-10 rounded border cursor-pointer"}),e.jsx("input",{className:"input flex-1",value:s[a.key]||a.default,onChange:n=>p(a.key,n.target.value)})]})]},a.key))}),e.jsxs("div",{className:"mt-4 p-4 bg-gray-50 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-500 mb-3",children:"Customer Panel Preview:"}),e.jsxs("div",{className:"flex gap-3 items-center flex-wrap",children:[e.jsx("div",{className:"h-9 px-5 rounded-full flex items-center justify-center text-white text-sm font-medium",style:{backgroundColor:s.primary_color||"#3B82F6"},children:"Add to Cart"}),e.jsx("div",{className:"h-9 px-5 rounded-full flex items-center justify-center text-white text-sm font-medium",style:{backgroundColor:s.secondary_color||"#1E40AF"},children:"View Cart"}),e.jsx("div",{className:"h-9 px-5 rounded-full flex items-center justify-center text-white text-sm font-medium",style:{backgroundColor:s.accent_color||"#F59E0B"},children:"Special Offer"})]})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Social Links"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Facebook"}),e.jsx("input",{className:"input",value:((S=s.social_links)==null?void 0:S.facebook)||"",onChange:a=>N("facebook",a.target.value),placeholder:"https://facebook.com/..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Instagram"}),e.jsx("input",{className:"input",value:((k=s.social_links)==null?void 0:k.instagram)||"",onChange:a=>N("instagram",a.target.value),placeholder:"https://instagram.com/..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Website"}),e.jsx("input",{className:"input",value:((F=s.social_links)==null?void 0:F.website)||"",onChange:a=>N("website",a.target.value),placeholder:"https://yourwebsite.com"})]})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{type:"submit",disabled:g.isPending,className:"btn-primary px-8",children:g.isPending?"Saving...":"Save Branding"})})]})}function L(){const{data:l,isLoading:s}=w({queryKey:["subscription-current"],queryFn:()=>R.current().then(r=>r.data.data)});return s?e.jsx(_,{}):e.jsxs("div",{className:"card",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Subscription"}),l!=null&&l.subscription?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Plan"}),e.jsx("span",{className:"font-medium capitalize",children:l.subscription.plan_type})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Status"}),e.jsx("span",{className:`font-medium ${l.expired?"text-red-600":"text-green-600"}`,children:l.expired?"Expired":"Active"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Expires"}),e.jsx("span",{children:new Date(l.subscription.expires_at).toLocaleDateString()})]}),l.days_remaining!==void 0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Days Remaining"}),e.jsxs("span",{className:`font-bold ${l.days_remaining<7?"text-red-600":""}`,children:[l.days_remaining," days"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Amount"}),e.jsxs("span",{className:"font-medium",children:["৳",l.subscription.amount]})]})]}):e.jsxs("div",{className:"text-center py-6",children:[e.jsx("p",{className:"text-red-600 font-medium",children:"No active subscription"}),e.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Contact support to renew"})]})]})}function D(){const l=C(),[s,r]=m.useState({vat_registered:!1,vat_number:"",default_vat_rate:"5.00",vat_inclusive:!1}),{data:d,isLoading:b}=w({queryKey:["tenant-branding"],queryFn:()=>y.get().then(i=>i.data.data)});m.useEffect(()=>{d&&r({vat_registered:!!d.vat_registered,vat_number:d.vat_number||"",default_vat_rate:d.default_vat_rate??"5.00",vat_inclusive:!!d.vat_inclusive})},[d]);const u=A({mutationFn:i=>y.update(i),onSuccess:()=>{l.invalidateQueries(["tenant-branding"]),j.success("VAT settings updated!")},onError:i=>{var c,g;return j.error(((g=(c=i.response)==null?void 0:c.data)==null?void 0:g.message)||"Failed to update")}}),x=i=>{i.preventDefault();const c=new FormData;c.append("vat_registered",s.vat_registered?"1":"0"),c.append("vat_number",s.vat_number),c.append("default_vat_rate",s.default_vat_rate),c.append("vat_inclusive",s.vat_inclusive?"1":"0"),u.mutate(c)};return b?e.jsx(_,{}):e.jsxs("form",{onSubmit:x,className:"space-y-6",children:[e.jsxs("div",{className:"card",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"VAT / BIN Configuration"}),e.jsx("p",{className:"text-sm text-gray-500 mb-6",children:"Configure your VAT settings for Bangladesh NBR compliance. These settings affect how invoices are generated and VAT is calculated."}),e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-800",children:"VAT Registered"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Enable if your restaurant is registered for VAT with NBR"})]}),e.jsx("button",{type:"button",onClick:()=>r(i=>({...i,vat_registered:!i.vat_registered})),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${s.vat_registered?"bg-blue-600":"bg-gray-300"}`,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${s.vat_registered?"translate-x-6":"translate-x-1"}`})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"BIN / VAT Registration Number"}),e.jsx("input",{className:"input",value:s.vat_number,onChange:i=>r(c=>({...c,vat_number:i.target.value})),placeholder:"Enter your 13-digit BIN number",maxLength:20}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Business Identification Number issued by NBR. Printed on invoices."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Default VAT Rate (%)"}),e.jsx("input",{type:"number",className:"input",value:s.default_vat_rate,onChange:i=>r(c=>({...c,default_vat_rate:i.target.value})),step:"0.01",min:"0",max:"100",placeholder:"5.00"}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Standard rate for restaurants in Bangladesh is 5%. Set to 0 to disable VAT."})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-800",children:"VAT Inclusive Pricing"}),e.jsx("p",{className:"text-sm text-gray-500",children:"When enabled, menu prices already include VAT. When disabled, VAT is added on top."})]}),e.jsx("button",{type:"button",onClick:()=>r(i=>({...i,vat_inclusive:!i.vat_inclusive})),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${s.vat_inclusive?"bg-blue-600":"bg-gray-300"}`,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${s.vat_inclusive?"translate-x-6":"translate-x-1"}`})})]}),e.jsxs("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsx("p",{className:"text-sm font-medium text-blue-800 mb-2",children:"Calculation Preview (item priced ৳100)"}),s.vat_inclusive?e.jsxs("div",{className:"text-sm text-blue-700 space-y-0.5",children:[e.jsx("p",{children:"Price shown: ৳100.00 (VAT included)"}),e.jsxs("p",{children:["VAT (",s.default_vat_rate,"%): ৳",(100*parseFloat(s.default_vat_rate||0)/(100+parseFloat(s.default_vat_rate||0))).toFixed(2)]}),e.jsxs("p",{children:["Net: ৳",(100-100*parseFloat(s.default_vat_rate||0)/(100+parseFloat(s.default_vat_rate||0))).toFixed(2)]}),e.jsx("p",{className:"font-bold",children:"Customer pays: ৳100.00"})]}):e.jsxs("div",{className:"text-sm text-blue-700 space-y-0.5",children:[e.jsx("p",{children:"Price shown: ৳100.00 (excl. VAT)"}),e.jsxs("p",{children:["VAT (",s.default_vat_rate,"%): ৳",(100*parseFloat(s.default_vat_rate||0)/100).toFixed(2)]}),e.jsxs("p",{className:"font-bold",children:["Customer pays: ৳",(100+100*parseFloat(s.default_vat_rate||0)/100).toFixed(2)]})]})]})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{type:"submit",disabled:u.isPending,className:"btn-primary px-8",children:u.isPending?"Saving...":"Save VAT Settings"})})]})}function z(){const[l,s]=m.useState("branding"),r=[{id:"branding",label:"Branding"},{id:"vat",label:"VAT Settings"},{id:"subscription",label:"Subscription"}];return e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-6",children:"Settings"}),e.jsx("div",{className:"flex gap-1 mb-6 bg-gray-100 rounded-lg p-1 w-fit",children:r.map(d=>e.jsx("button",{onClick:()=>s(d.id),className:`px-4 py-2 text-sm font-medium rounded-md transition-colors ${l===d.id?"bg-white text-blue-700 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:d.label},d.id))}),l==="branding"&&e.jsx(I,{}),l==="vat"&&e.jsx(D,{}),l==="subscription"&&e.jsx(L,{})]})}export{z as default};
