import{q as te,w as se,r as g,j as e,x as re,o as ae,z as O,u as ne,v as le,k as ie,m as oe,t as ce}from"./index-DOj4cv-Y.js";import{u as H}from"./useQuery-v6eG86EQ.js";import{e as W,k as Z,i as de,z as ue,A as xe,D as me,E as U,t as he,F as ee,G as pe,I as ge,J as be,C as fe,u as ye,K as ve}from"./index-BdfqSiwZ.js";import{P as je}from"./POSInvoice-aSFl1tHN.js";import"./iconBase-um1MA9Tc.js";const Ne=0;function F(i="Order 1"){return{id:Date.now().toString(),label:i,orderType:"dine",tableId:null,tableName:null,customerName:"",customerPhone:"",notes:"",items:[],voucherCode:"",voucherDiscount:0,voucherId:null}}const we=te(se((i,r)=>({carts:[F("Order 1")],activeCartId:null,getActiveCart(){const{carts:t,activeCartId:n}=r();return t.length?t.find(a=>a.id===n)??t[0]:null},setActiveCart(t){i({activeCartId:t})},createCart(){const{carts:t}=r(),n=`Order ${t.length+1}`,a=F(n);i({carts:[...t,a],activeCartId:a.id})},deleteCart(t){const{carts:n,activeCartId:a}=r(),l=n.filter(o=>o.id!==t);if(!l.length){const o=F("Order 1");i({carts:[o],activeCartId:o.id});return}const d=a===t?l[l.length-1].id:a;i({carts:l,activeCartId:d})},clearActiveCart(){const{carts:t,activeCartId:n}=r(),a=F("Order 1");t.length===1?i({carts:[a],activeCartId:a.id}):i({carts:t.filter(l=>l.id!==(n??t[0].id)),activeCartId:null})},_updateActive(t){var d;const{carts:n,activeCartId:a}=r(),l=a??((d=n[0])==null?void 0:d.id);i({carts:n.map(o=>o.id===l?{...o,...t(o)}:o)})},setOrderType(t){r()._updateActive(()=>({orderType:t,tableId:t!=="dine"?null:void 0,tableName:t!=="dine"?null:void 0}))},setTable(t,n){r()._updateActive(()=>({tableId:t,tableName:n}))},setCustomer(t,n){r()._updateActive(()=>({customerName:t,customerPhone:n}))},setNotes(t){r()._updateActive(()=>({notes:t}))},setVoucher(t,n,a){r()._updateActive(()=>({voucherCode:t,voucherDiscount:n,voucherId:a}))},clearVoucher(){r()._updateActive(()=>({voucherCode:"",voucherDiscount:0,voucherId:null}))},updateCartLabel(t,n){const{carts:a}=r();i({carts:a.map(l=>l.id===t?{...l,label:n}:l)})},addItem(t){r()._updateActive(n=>n.items.find(l=>l.menu_item_id===t.id)?{items:n.items.map(l=>l.menu_item_id===t.id?{...l,qty:l.qty+1}:l)}:{items:[...n.items,{menu_item_id:t.id,name:t.name,price:parseFloat(t.price),qty:1,special_instructions:""}]})},updateQty(t,n){if(n<=0){r().removeItem(t);return}r()._updateActive(a=>({items:a.items.map(l=>l.menu_item_id===t?{...l,qty:n}:l)}))},updateInstructions(t,n){r()._updateActive(a=>({items:a.items.map(l=>l.menu_item_id===t?{...l,special_instructions:n}:l)}))},removeItem(t){r()._updateActive(n=>({items:n.items.filter(a=>a.menu_item_id!==t)}))},getCartTotals(t=Ne,n=!1){const a=r().getActiveCart();if(!a)return{subtotal:0,discount:0,netAmount:0,vat:0,grandTotal:0};const l=a.items.reduce((y,v)=>y+v.price*v.qty,0),d=a.voucherDiscount??0,o=Math.max(0,l-d);let x,p,h;return n?(x=Math.round(o*(t/(100+t))*100)/100,p=Math.round((o-x)*100)/100,h=o):(p=o,x=Math.round(o*(t/100)*100)/100,h=o+x),{subtotal:l,discount:d,netAmount:p,vat:x,grandTotal:h}},getTotalItems(){const t=r().getActiveCart();return t?t.items.reduce((n,a)=>n+a.qty,0):0}}),{name:"pos-store",partialize:i=>({carts:i.carts,activeCartId:i.activeCartId})})),Ce=[{id:"cash",label:"Cash",icon:Z,color:"blue"},{id:"card",label:"Card / POS Machine",icon:de,color:"purple"},{id:"mobile_banking",label:"Mobile Banking",icon:ue,color:"green"}],_e={blue:{ring:"ring-blue-500",bg:"bg-blue-50",text:"text-blue-700",icon:"text-blue-500"},purple:{ring:"ring-purple-500",bg:"bg-purple-50",text:"text-purple-700",icon:"text-purple-500"},green:{ring:"ring-green-500",bg:"bg-green-50",text:"text-green-700",icon:"text-green-500"}};function Te({cart:i,totals:r,onSuccess:t,onClose:n}){const[a,l]=g.useState("cash"),[d,o]=g.useState(""),[x,p]=g.useState(""),[h,y]=g.useState(!1),[v,T]=g.useState(null),I=a==="cash"?Math.max(0,parseFloat(d||0)-r.grandTotal):0,w=i.items.length>0&&!h&&(a!=="cash"||parseFloat(d||0)>=r.grandTotal);async function j(c){var b,C,P,S;y(!0);try{const _={type:i.orderType,table_id:i.tableId??void 0,customer_name:i.customerName||void 0,customer_phone:i.customerPhone||void 0,notes:i.notes||void 0,items:i.items.map(A=>({menu_item_id:A.menu_item_id,qty:A.qty,special_instructions:A.special_instructions||void 0})),voucher_code:i.voucherCode||void 0,payment_method:a,payment_status:c,transaction_id:x||void 0},k=(b=(await re.createOrder(_)).data)==null?void 0:b.data,M=await ae.invoice(k.order_number);T(((C=M.data)==null?void 0:C.data)??{order:k,restaurant:null}),O.success("Order created!")}catch(_){const m=((S=(P=_.response)==null?void 0:P.data)==null?void 0:S.message)??"Failed to create order";O.error(m),y(!1)}}function q(){T(null),t()}return v?e.jsx(je,{data:v,onClose:q}):e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-md",onClick:c=>c.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Collect Payment"}),e.jsx("button",{onClick:n,className:"text-gray-400 hover:text-gray-600",children:e.jsx(W,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"p-6 space-y-5",children:[e.jsxs("div",{className:"text-center py-3 bg-gray-50 rounded-xl",children:[e.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Total Amount Due"}),e.jsxs("p",{className:"text-4xl font-bold text-gray-900",children:["à§³",r.grandTotal.toFixed(2)]}),r.discount>0&&e.jsxs("p",{className:"text-sm text-green-600 mt-1",children:["Voucher discount: -à§³",r.discount.toFixed(2)]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 mb-2",children:"Payment Method"}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:Ce.map(c=>{const b=_e[c.color],C=a===c.id;return e.jsxs("button",{onClick:()=>{l(c.id),o(""),p("")},className:`flex flex-col items-center justify-center gap-1.5 py-3 px-2 rounded-xl border-2 transition-all text-center ${C?`${b.bg} ${b.ring} ring-2 border-transparent ${b.text}`:"border-gray-200 text-gray-500 hover:border-gray-300"}`,children:[e.jsx(c.icon,{className:`w-6 h-6 ${C?b.icon:"text-gray-400"}`}),e.jsx("span",{className:"text-xs font-medium leading-tight",children:c.label})]},c.id)})})]}),a==="cash"&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tendered Amount (à§³)"}),e.jsx("input",{type:"number",min:r.grandTotal,step:"0.01",value:d,onChange:c=>o(c.target.value),placeholder:`Min à§³${r.grandTotal.toFixed(2)}`,className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-lg font-semibold focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none",autoFocus:!0})]}),parseFloat(d||0)>0&&e.jsxs("div",{className:`flex justify-between items-center px-4 py-2.5 rounded-lg ${I>0?"bg-green-50 text-green-700":"bg-red-50 text-red-600"}`,children:[e.jsx("span",{className:"font-medium",children:"Change Due"}),e.jsxs("span",{className:"text-xl font-bold",children:["à§³",I.toFixed(2)]})]})]}),(a==="card"||a==="mobile_banking")&&e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[a==="card"?"Card / POS Reference No.":"bKash / Nagad Transaction ID",e.jsx("span",{className:"text-gray-400 font-normal ml-1",children:"(optional)"})]}),e.jsx("input",{type:"text",value:x,onChange:c=>p(c.target.value),placeholder:"Enter reference number...",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none",autoFocus:!0})]}),e.jsxs("div",{className:"space-y-2 pt-1",children:[e.jsxs("button",{disabled:!w,onClick:()=>j("paid"),className:"w-full flex items-center justify-center gap-2 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed text-white font-semibold py-3 rounded-xl transition-colors",children:[h?e.jsxs("svg",{className:"animate-spin w-5 h-5",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v8H4z"})]}):e.jsx(xe,{className:"w-5 h-5"}),"Mark as Paid & Print Receipt"]}),e.jsx("button",{disabled:h||i.items.length===0,onClick:()=>j("pending"),className:"w-full text-sm text-gray-500 hover:text-gray-700 py-2 disabled:opacity-40 disabled:cursor-not-allowed transition-colors",children:"Place Order â€” Pay Later"})]})]})]})})}const Ie=[{id:"dine",label:"Dine-In",icon:he},{id:"parcel",label:"Takeaway",icon:ee},{id:"quick",label:"Quick Sale",icon:pe}];function ke({carts:i,activeCartId:r,onSelect:t,onCreate:n,onDelete:a}){var d;const l=r??((d=i[0])==null?void 0:d.id);return e.jsxs("div",{className:"flex items-center gap-1 overflow-x-auto pb-1 min-h-[38px]",children:[i.map(o=>{const x=o.id===l,p=o.items.reduce((h,y)=>h+y.price*y.qty,0);return e.jsxs("div",{onClick:()=>t(o.id),className:`flex items-center gap-1.5 px-3 py-1.5 rounded-lg text-sm font-medium cursor-pointer whitespace-nowrap select-none transition-colors ${x?"bg-blue-600 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:[e.jsx("span",{children:o.label}),p>0&&e.jsxs("span",{className:`text-xs ${x?"text-blue-200":"text-gray-400"}`,children:["à§³",p.toFixed(0)]}),i.length>1&&e.jsx("button",{onClick:h=>{h.stopPropagation(),a(o.id)},className:`ml-0.5 rounded hover:bg-white/20 p-0.5 ${x?"text-blue-200 hover:text-white":"text-gray-400 hover:text-red-500"}`,children:e.jsx(W,{className:"w-3 h-3"})})]},o.id)}),i.length<5&&e.jsxs("button",{onClick:n,className:"flex items-center gap-1 px-2.5 py-1.5 rounded-lg text-sm text-gray-500 hover:bg-gray-100 border border-dashed border-gray-300 whitespace-nowrap",children:[e.jsx(ve,{className:"w-3.5 h-3.5"}),"New"]})]})}function qe(){var $,V,D,E,X,L,R,z,K,Q,B,G,Y;const{user:i}=ne(),r=we(),t=r.getActiveCart(),[n,a]=g.useState(""),[l,d]=g.useState(null),[o,x]=g.useState((t==null?void 0:t.voucherCode)??""),[p,h]=g.useState(!1),[y,v]=g.useState(!1),T=parseFloat((($=i==null?void 0:i.tenant)==null?void 0:$.default_vat_rate)??0),I=!!((V=i==null?void 0:i.tenant)!=null&&V.vat_inclusive),{data:w}=H({queryKey:["pos-categories"],queryFn:()=>ie.list({per_page:100}),staleTime:3e4}),{data:j,refetch:q}=H({queryKey:["pos-menu"],queryFn:()=>oe.list({per_page:200}),staleTime:3e4}),{data:c,refetch:b}=H({queryKey:["pos-tables"],queryFn:()=>ce.list({per_page:100}),staleTime:1e4}),C=((E=(D=w==null?void 0:w.data)==null?void 0:D.data)==null?void 0:E.data)??((X=w==null?void 0:w.data)==null?void 0:X.data)??[],P=((R=(L=j==null?void 0:j.data)==null?void 0:L.data)==null?void 0:R.data)??((z=j==null?void 0:j.data)==null?void 0:z.data)??[],S=((Q=(K=c==null?void 0:c.data)==null?void 0:K.data)==null?void 0:Q.data)??((B=c==null?void 0:c.data)==null?void 0:B.data)??[],_=P.filter(s=>!s.is_active||l&&s.category_id!==l?!1:n?s.name.toLowerCase().includes(n.toLowerCase()):!0);g.useEffect(()=>{x((t==null?void 0:t.voucherCode)??"")},[t==null?void 0:t.id]);const m=r.getCartTotals(T,I);async function k(){var s,u,f;if(o.trim()){h(!0);try{const N=(u=(await le.validate({code:o.trim(),subtotal:m.subtotal,tenant_id:(s=i==null?void 0:i.tenant)==null?void 0:s.id})).data)==null?void 0:u.data;r.setVoucher(o.trim(),(N==null?void 0:N.discount)??0,((f=N==null?void 0:N.voucher)==null?void 0:f.id)??null),O.success(`Voucher applied! -à§³${((N==null?void 0:N.discount)??0).toFixed(2)}`)}catch{O.error("Invalid or expired voucher code"),r.clearVoucher()}finally{h(!1)}}}function M(){r.clearVoucher(),x("")}function A(){v(!1),r.clearActiveCart(),b(),O.success("Cart cleared â€” ready for next order")}return t?e.jsxs("div",{className:"flex h-[calc(100vh-64px)] bg-gray-100 overflow-hidden",children:[e.jsxs("div",{className:"flex flex-col w-[58%] bg-white border-r border-gray-200 overflow-hidden",children:[e.jsxs("div",{className:"px-4 pt-4 pb-3 border-b border-gray-100 space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-base font-semibold text-gray-800",children:"POS Terminal"}),e.jsx("button",{onClick:()=>{q(),b()},className:"text-gray-400 hover:text-blue-500 p-1 rounded",title:"Refresh menu & tables",children:e.jsx(me,{className:"w-4 h-4"})})]}),e.jsx(ke,{carts:r.carts,activeCartId:r.activeCartId,onSelect:r.setActiveCart.bind(r),onCreate:r.createCart.bind(r),onDelete:s=>{var f;const u=r.carts.find(J=>J.id===s);((f=u==null?void 0:u.items)==null?void 0:f.length)>0&&!window.confirm("Delete this order cart?")||r.deleteCart(s)}}),e.jsxs("div",{className:"relative",children:[e.jsx(U,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx("input",{value:n,onChange:s=>a(s.target.value),placeholder:"Search menu itemsâ€¦",className:"w-full pl-9 pr-4 py-2 text-sm border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none"})]})]}),e.jsxs("div",{className:"flex gap-2 px-4 py-2 overflow-x-auto border-b border-gray-100 shrink-0",children:[e.jsx("button",{onClick:()=>d(null),className:`px-3 py-1.5 rounded-full text-xs font-medium whitespace-nowrap transition-colors ${l===null?"bg-blue-600 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:"All"}),C.map(s=>e.jsx("button",{onClick:()=>d(s.id),className:`px-3 py-1.5 rounded-full text-xs font-medium whitespace-nowrap transition-colors ${l===s.id?"bg-blue-600 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:s.name},s.id))]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-3",children:_.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-40 text-gray-400",children:[e.jsx(U,{className:"w-8 h-8 mb-2"}),e.jsx("p",{className:"text-sm",children:"No items found"})]}):e.jsx("div",{className:"grid grid-cols-3 xl:grid-cols-4 gap-2.5",children:_.map(s=>{const u=t.items.find(f=>f.menu_item_id===s.id);return e.jsxs("button",{onClick:()=>r.addItem(s),className:`relative flex flex-col rounded-xl border text-left transition-all hover:shadow-md active:scale-[0.97] overflow-hidden ${u?"border-blue-400 ring-2 ring-blue-100":"border-gray-200 hover:border-blue-300"}`,children:[e.jsx("div",{className:"h-24 bg-gray-100 overflow-hidden",children:s.image_url?e.jsx("img",{src:s.image_url,alt:s.name,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-300 text-2xl",children:"ðŸ½"})}),e.jsxs("div",{className:"p-2 flex-1 flex flex-col",children:[e.jsx("p",{className:"text-xs font-semibold text-gray-800 leading-tight line-clamp-2",children:s.name}),e.jsxs("p",{className:"text-sm font-bold text-blue-600 mt-auto pt-1",children:["à§³",parseFloat(s.price).toFixed(2)]})]}),u&&e.jsx("div",{className:"absolute top-1.5 right-1.5 bg-blue-600 text-white text-xs font-bold rounded-full w-5 h-5 flex items-center justify-center",children:u.qty})]},s.id)})})})]}),e.jsxs("div",{className:"flex flex-col w-[42%] bg-white overflow-hidden",children:[e.jsxs("div",{className:"px-4 pt-4 pb-3 border-b border-gray-100 space-y-3",children:[e.jsx("div",{className:"flex bg-gray-100 rounded-xl p-1 gap-1",children:Ie.map(s=>{const u=t.orderType===s.id;return e.jsxs("button",{onClick:()=>r.setOrderType(s.id),className:`flex-1 flex items-center justify-center gap-1.5 py-2 rounded-lg text-xs font-semibold transition-all ${u?"bg-white text-blue-700 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:[e.jsx(s.icon,{className:"w-3.5 h-3.5"}),s.label]},s.id)})}),t.orderType==="dine"&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 mb-2",children:"Select Table"}),e.jsx("div",{className:"grid grid-cols-4 gap-1.5 max-h-28 overflow-y-auto",children:S.filter(s=>s.status!=="inactive").map(s=>{const u=t.tableId===s.id,f=s.status==="occupied";return e.jsxs("button",{onClick:()=>r.setTable(s.id,s.table_number),className:`py-2 rounded-lg text-xs font-semibold border transition-all ${u?"bg-blue-600 text-white border-blue-600":f?"bg-orange-50 text-orange-600 border-orange-200 hover:border-orange-400":"bg-green-50 text-green-700 border-green-200 hover:border-green-400"}`,children:["T",s.table_number,f&&!u&&e.jsx("span",{className:"block text-[9px] leading-none text-orange-400",children:"busy"})]},s.id)})}),t.tableId&&e.jsxs("p",{className:"mt-1 text-xs text-blue-600 font-medium",children:["âœ“ Table ",t.tableName," selected"]})]}),t.orderType==="parcel"&&e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1 font-medium",children:"Customer Name *"}),e.jsx("input",{value:t.customerName,onChange:s=>r.setCustomer(s.target.value,t.customerPhone),placeholder:"Name",className:"w-full border border-gray-200 rounded-lg px-2.5 py-1.5 text-sm focus:ring-2 focus:ring-blue-500 outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1 font-medium",children:"Phone"}),e.jsx("input",{value:t.customerPhone,onChange:s=>r.setCustomer(t.customerName,s.target.value),placeholder:"01XXXXXXXXX",className:"w-full border border-gray-200 rounded-lg px-2.5 py-1.5 text-sm focus:ring-2 focus:ring-blue-500 outline-none"})]})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto px-4 py-2 space-y-1.5",children:t.items.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-32 text-gray-300",children:[e.jsx(ee,{className:"w-10 h-10 mb-2"}),e.jsx("p",{className:"text-sm font-medium",children:"Cart is empty"}),e.jsx("p",{className:"text-xs",children:"Tap items on the left to add"})]}):t.items.map(s=>e.jsxs("div",{className:"p-2.5 rounded-xl bg-gray-50 border border-gray-100",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-semibold text-gray-800 truncate",children:s.name}),e.jsxs("p",{className:"text-xs text-gray-500",children:["à§³",s.price.toFixed(2)," each"]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>r.updateQty(s.menu_item_id,s.qty-1),className:"w-6 h-6 rounded-full bg-gray-200 hover:bg-red-100 hover:text-red-600 flex items-center justify-center transition-colors",children:e.jsx(ge,{className:"w-4 h-4"})}),e.jsx("span",{className:"w-7 text-center text-sm font-bold",children:s.qty}),e.jsx("button",{onClick:()=>r.updateQty(s.menu_item_id,s.qty+1),className:"w-6 h-6 rounded-full bg-gray-200 hover:bg-green-100 hover:text-green-600 flex items-center justify-center transition-colors",children:e.jsx(be,{className:"w-4 h-4"})})]}),e.jsxs("p",{className:"text-sm font-bold text-gray-800 w-16 text-right",children:["à§³",(s.price*s.qty).toFixed(2)]}),e.jsx("button",{onClick:()=>r.removeItem(s.menu_item_id),className:"text-gray-300 hover:text-red-500 transition-colors",children:e.jsx(fe,{className:"w-4 h-4"})})]}),e.jsx("div",{className:"mt-1.5",children:e.jsx("input",{value:s.special_instructions??"",onChange:u=>r.updateInstructions(s.menu_item_id,u.target.value),placeholder:"Special instructionsâ€¦",className:"w-full text-[11px] text-gray-500 bg-transparent border-0 border-b border-dashed border-gray-200 focus:border-blue-400 px-0 py-0.5 outline-none placeholder:text-gray-300"})})]},s.menu_item_id))}),e.jsxs("div",{className:"border-t border-gray-100 px-4 py-3 space-y-3",children:[e.jsx("input",{value:t.notes,onChange:s=>r.setNotes(s.target.value),placeholder:"Order notes (optional)â€¦",className:"w-full text-xs border border-gray-200 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 outline-none resize-none"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(ye,{className:"absolute left-2.5 top-1/2 -translate-y-1/2 text-gray-400 w-3.5 h-3.5"}),e.jsx("input",{value:o,onChange:s=>x(s.target.value),onKeyDown:s=>s.key==="Enter"&&k(),placeholder:"Voucher code",disabled:!!t.voucherCode,className:"w-full pl-8 pr-3 py-1.5 text-xs border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none disabled:bg-gray-50 disabled:text-gray-400"})]}),t.voucherCode?e.jsx("button",{onClick:M,className:"px-3 py-1.5 text-xs text-red-600 border border-red-200 rounded-lg hover:bg-red-50",children:"Remove"}):e.jsx("button",{onClick:k,disabled:!o.trim()||p,className:"px-3 py-1.5 text-xs bg-gray-800 text-white rounded-lg hover:bg-gray-700 disabled:bg-gray-300 disabled:cursor-not-allowed",children:p?"â€¦":"Apply"})]}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("div",{className:"flex justify-between text-gray-500",children:[e.jsx("span",{children:"Subtotal"}),e.jsxs("span",{children:["à§³",m.subtotal.toFixed(2)]})]}),m.discount>0&&e.jsxs("div",{className:"flex justify-between text-green-600",children:[e.jsx("span",{children:"Voucher Discount"}),e.jsxs("span",{children:["-à§³",m.discount.toFixed(2)]})]}),m.netAmount!==m.subtotal-m.discount&&e.jsxs("div",{className:"flex justify-between text-gray-500",children:[e.jsx("span",{children:"Net Amount"}),e.jsxs("span",{children:["à§³",m.netAmount.toFixed(2)]})]}),m.vat>0&&e.jsxs("div",{className:"flex justify-between text-gray-500",children:[e.jsxs("span",{children:["VAT (",T,"%)",I?" (incl.)":""]}),e.jsxs("span",{children:["à§³",m.vat.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between font-bold text-gray-900 text-base pt-1 border-t border-gray-200",children:[e.jsx("span",{children:"Grand Total"}),e.jsxs("span",{children:["à§³",m.grandTotal.toFixed(2)]})]})]}),e.jsxs("button",{disabled:t.items.length===0||t.orderType==="dine"&&!t.tableId||t.orderType==="parcel"&&!((G=t.customerName)!=null&&G.trim()),onClick:()=>v(!0),className:"w-full flex items-center justify-center gap-2 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed text-white font-bold py-3 rounded-xl transition-colors text-sm",children:[e.jsx(Z,{className:"w-5 h-5"}),"Collect Payment â€” à§³",m.grandTotal.toFixed(2)]}),t.orderType==="dine"&&!t.tableId&&t.items.length>0&&e.jsx("p",{className:"text-xs text-center text-amber-600",children:"Please select a table to proceed"}),t.orderType==="parcel"&&!((Y=t.customerName)!=null&&Y.trim())&&t.items.length>0&&e.jsx("p",{className:"text-xs text-center text-amber-600",children:"Customer name is required for takeaway"})]})]}),y&&e.jsx(Te,{cart:t,totals:m,onSuccess:A,onClose:()=>v(!1)})]}):null}export{qe as default};
