import{j as e,L as f,h,l as w}from"./index-CanGr6k3.js";import{u as _}from"./useQuery-Dl6J-XZU.js";import{P as $,Q as y,h as D,R as T,r as R,i as C}from"./index-c6C0Wc7z.js";import"./iconBase-CaRTzVFD.js";const v=({data:l,color:x="blue"})=>{if(!l||l.length===0)return e.jsx("div",{className:"text-gray-400 text-sm",children:"No data"});const c=Math.max(...l.map(s=>s.count||s.revenue||0));return e.jsx("div",{className:"flex items-end gap-1 h-16",children:l.slice(-12).map((s,t)=>{const r=s.count||s.revenue||0,m=c>0?r/c*100:0;return e.jsx("div",{className:`flex-1 bg-${x}-500 rounded-t opacity-80 hover:opacity-100 transition-opacity`,style:{height:`${Math.max(m,4)}%`},title:`${s.month}: ${r}`},t)})})},o=({icon:l,label:x,value:c,subValue:s,color:t="blue",trend:r})=>e.jsxs("div",{className:"bg-white rounded-xl p-5 shadow-sm border border-gray-100",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:x}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:c}),s&&e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:s})]}),e.jsx("div",{className:`p-3 rounded-xl bg-${t}-50`,children:e.jsx(l,{className:`w-6 h-6 text-${t}-600`})})]}),r!==void 0&&e.jsxs("div",{className:`flex items-center mt-3 text-sm ${r>=0?"text-green-600":"text-red-600"}`,children:[r>=0?"↑":"↓"," ",Math.abs(r),"% from last month"]})]});function A(){var u,j,b;const{data:l,isLoading:x,error:c}=_({queryKey:["admin-dashboard"],queryFn:()=>w.get().then(a=>a.data.data),refetchInterval:6e4});if(x)return e.jsx(f,{});if(c)return e.jsx("div",{className:"text-red-500",children:"Error loading dashboard"});const{kpi:s,charts:t,top_tenants:r,recent_tenants:m,recent_subscriptions:g}=l||{},d=a=>new Intl.NumberFormat("en-BD",{style:"currency",currency:"BDT",minimumFractionDigits:0,maximumFractionDigits:0}).format(a||0);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Super Admin Dashboard"}),e.jsx("p",{className:"text-gray-500 mt-1",children:"Platform overview and analytics"})]}),(s==null?void 0:s.expiring_soon)>0&&e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-xl p-4 flex items-center gap-3",children:[e.jsx($,{className:"w-6 h-6 text-yellow-600 shrink-0"}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium text-yellow-800",children:[s.expiring_soon," subscription",s.expiring_soon>1?"s":""," expiring soon"]}),e.jsx(h,{to:"/dashboard/admin/subscriptions",className:"text-sm text-yellow-700 underline",children:"View expiring subscriptions →"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6 gap-4",children:[e.jsx(o,{icon:y,label:"MRR",value:d(s==null?void 0:s.mrr),color:"green"}),e.jsx(o,{icon:y,label:"ARR",value:d(s==null?void 0:s.arr),color:"green"}),e.jsx(o,{icon:D,label:"Active Tenants",value:(s==null?void 0:s.active_tenants)||0,subValue:`${(s==null?void 0:s.inactive_tenants)||0} inactive`,color:"blue"}),e.jsx(o,{icon:T,label:"Churn Rate",value:`${(s==null?void 0:s.churn_rate)||0}%`,color:"red"}),e.jsx(o,{icon:R,label:"Orders Today",value:(s==null?void 0:s.orders_today)||0,subValue:`${(s==null?void 0:s.orders_this_month)||0} this month`,color:"purple"}),e.jsx(o,{icon:C,label:"Revenue Today",value:d(s==null?void 0:s.revenue_today),subValue:`${d(s==null?void 0:s.revenue_this_month)} this month`,color:"indigo"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-100",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"New Tenants (Last 12 Months)"}),e.jsx(v,{data:t==null?void 0:t.new_tenants_per_month,color:"blue"}),e.jsx("div",{className:"flex justify-between text-xs text-gray-400 mt-2",children:(u=t==null?void 0:t.new_tenants_per_month)==null?void 0:u.slice(-6).map((a,i)=>{var n;return e.jsx("span",{children:(n=a.month)==null?void 0:n.split("-")[1]},i)})})]}),e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-100",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Revenue Trend (Last 12 Months)"}),e.jsx(v,{data:t==null?void 0:t.revenue_trend,color:"green"}),e.jsx("div",{className:"flex justify-between text-xs text-gray-400 mt-2",children:(j=t==null?void 0:t.revenue_trend)==null?void 0:j.slice(-6).map((a,i)=>{var n;return e.jsx("span",{children:(n=a.month)==null?void 0:n.split("-")[1]},i)})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-100",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Top Tenants (This Month)"}),e.jsx("div",{className:"space-y-3",children:(r==null?void 0:r.length)>0?r.map((a,i)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"w-6 h-6 bg-gray-100 rounded-full flex items-center justify-center text-xs font-medium text-gray-600",children:i+1}),e.jsxs("div",{children:[e.jsx(h,{to:`/dashboard/admin/tenants/${a.id}`,className:"font-medium text-gray-900 hover:text-blue-600",children:a.name}),e.jsxs("p",{className:"text-xs text-gray-400",children:[a.order_count," orders"]})]})]}),e.jsx("span",{className:"font-semibold text-gray-900",children:d(a.total_revenue)})]},a.id)):e.jsx("p",{className:"text-gray-400 text-sm",children:"No data available"})})]}),e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-100",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Plan Distribution"}),e.jsx("div",{className:"space-y-3",children:(b=t==null?void 0:t.plan_distribution)==null?void 0:b.map(a=>{const i=t.plan_distribution.reduce((N,p)=>N+p.count,0),n=i>0?a.count/i*100:0;return e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsx("span",{className:"capitalize text-gray-700",children:a.plan_type}),e.jsxs("span",{className:"text-gray-500",children:[a.count," (",n.toFixed(0),"%)"]})]}),e.jsx("div",{className:"h-2 bg-gray-100 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-blue-500 rounded-full",style:{width:`${n}%`}})})]},a.plan_type)})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-100",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"Recent Tenants"}),e.jsx(h,{to:"/dashboard/admin/tenants",className:"text-sm text-blue-600 hover:underline",children:"View all →"})]}),e.jsx("div",{className:"space-y-3",children:m==null?void 0:m.map(a=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(h,{to:`/dashboard/admin/tenants/${a.id}`,className:"font-medium text-gray-900 hover:text-blue-600",children:a.name}),e.jsx("p",{className:"text-xs text-gray-400",children:new Date(a.created_at).toLocaleDateString()})]}),e.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${a.is_active?"bg-green-100 text-green-700":"bg-gray-100 text-gray-600"}`,children:a.is_active?"Active":"Inactive"})]},a.id))})]}),e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-100",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"Recent Subscriptions"}),e.jsx(h,{to:"/dashboard/admin/subscriptions",className:"text-sm text-blue-600 hover:underline",children:"View all →"})]}),e.jsx("div",{className:"space-y-3",children:g==null?void 0:g.map(a=>{var i;return e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:(i=a.tenant)==null?void 0:i.name}),e.jsxs("p",{className:"text-xs text-gray-400 capitalize",children:[a.plan_type," • Expires ",new Date(a.expires_at).toLocaleDateString()]})]}),e.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${a.status==="active"?"bg-green-100 text-green-700":"bg-gray-100 text-gray-600"}`,children:a.status})]},a.id)})})]})]}),e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-100",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Financial Summary"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Pending Commission"}),e.jsx("p",{className:"text-xl font-bold text-yellow-600",children:d(s==null?void 0:s.pending_commission)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Total Collected"}),e.jsx("p",{className:"text-xl font-bold text-green-600",children:d(s==null?void 0:s.total_collected)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Total Users"}),e.jsx("p",{className:"text-xl font-bold text-gray-900",children:(l==null?void 0:l.users_count)||0})]})]})]})]})}export{A as default};
