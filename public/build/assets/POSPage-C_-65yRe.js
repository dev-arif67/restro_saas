import{q as J,w as Z,r as g,j as e,x as ee,o as te,z as k,u as se,v as re,k as ae,m as ne,t as le}from"./index-VcNFqetI.js";import{u as M}from"./useQuery-Rt3S72ZS.js";import{r as Y,h as G,l as oe,t as ie,u as ce,y as de,z as Q,e as ue,A as U,B as xe,C as me,D as he,x as pe,f as ge,E as be}from"./index-DXY5cShP.js";import{P as fe}from"./POSInvoice-0SuoJ50S.js";const ye=0;function F(o="Order 1"){return{id:Date.now().toString(),label:o,orderType:"dine",tableId:null,tableName:null,customerName:"",customerPhone:"",notes:"",items:[],voucherCode:"",voucherDiscount:0,voucherId:null}}const ve=J(Z((o,r)=>({carts:[F("Order 1")],activeCartId:null,getActiveCart(){const{carts:t,activeCartId:a}=r();return t.length?t.find(n=>n.id===a)??t[0]:null},setActiveCart(t){o({activeCartId:t})},createCart(){const{carts:t}=r(),a=`Order ${t.length+1}`,n=F(a);o({carts:[...t,n],activeCartId:n.id})},deleteCart(t){const{carts:a,activeCartId:n}=r(),l=a.filter(i=>i.id!==t);if(!l.length){const i=F("Order 1");o({carts:[i],activeCartId:i.id});return}const c=n===t?l[l.length-1].id:n;o({carts:l,activeCartId:c})},clearActiveCart(){const{carts:t,activeCartId:a}=r(),n=F("Order 1");t.length===1?o({carts:[n],activeCartId:n.id}):o({carts:t.filter(l=>l.id!==(a??t[0].id)),activeCartId:null})},_updateActive(t){var c;const{carts:a,activeCartId:n}=r(),l=n??((c=a[0])==null?void 0:c.id);o({carts:a.map(i=>i.id===l?{...i,...t(i)}:i)})},setOrderType(t){r()._updateActive(()=>({orderType:t,tableId:t!=="dine"?null:void 0,tableName:t!=="dine"?null:void 0}))},setTable(t,a){r()._updateActive(()=>({tableId:t,tableName:a}))},setCustomer(t,a){r()._updateActive(()=>({customerName:t,customerPhone:a}))},setNotes(t){r()._updateActive(()=>({notes:t}))},setVoucher(t,a,n){r()._updateActive(()=>({voucherCode:t,voucherDiscount:a,voucherId:n}))},clearVoucher(){r()._updateActive(()=>({voucherCode:"",voucherDiscount:0,voucherId:null}))},updateCartLabel(t,a){const{carts:n}=r();o({carts:n.map(l=>l.id===t?{...l,label:a}:l)})},addItem(t){r()._updateActive(a=>a.items.find(l=>l.menu_item_id===t.id)?{items:a.items.map(l=>l.menu_item_id===t.id?{...l,qty:l.qty+1}:l)}:{items:[...a.items,{menu_item_id:t.id,name:t.name,price:parseFloat(t.price),qty:1,special_instructions:""}]})},updateQty(t,a){if(a<=0){r().removeItem(t);return}r()._updateActive(n=>({items:n.items.map(l=>l.menu_item_id===t?{...l,qty:a}:l)}))},updateInstructions(t,a){r()._updateActive(n=>({items:n.items.map(l=>l.menu_item_id===t?{...l,special_instructions:a}:l)}))},removeItem(t){r()._updateActive(a=>({items:a.items.filter(n=>n.menu_item_id!==t)}))},getCartTotals(t=ye){const a=r().getActiveCart();if(!a)return{subtotal:0,discount:0,tax:0,grandTotal:0};const n=a.items.reduce((b,m)=>b+m.price*m.qty,0),l=a.voucherDiscount??0,c=Math.max(0,n-l),i=Math.round(c*(t/100)*100)/100,p=c+i;return{subtotal:n,discount:l,tax:i,grandTotal:p}},getTotalItems(){const t=r().getActiveCart();return t?t.items.reduce((a,n)=>a+n.qty,0):0}}),{name:"pos-store",partialize:o=>({carts:o.carts,activeCartId:o.activeCartId})})),je=[{id:"cash",label:"Cash",icon:G,color:"blue"},{id:"card",label:"Card / POS Machine",icon:oe,color:"purple"},{id:"mobile_banking",label:"Mobile Banking",icon:ie,color:"green"}],Ne={blue:{ring:"ring-blue-500",bg:"bg-blue-50",text:"text-blue-700",icon:"text-blue-500"},purple:{ring:"ring-purple-500",bg:"bg-purple-50",text:"text-purple-700",icon:"text-purple-500"},green:{ring:"ring-green-500",bg:"bg-green-50",text:"text-green-700",icon:"text-green-500"}};function we({cart:o,totals:r,onSuccess:t,onClose:a}){const[n,l]=g.useState("cash"),[c,i]=g.useState(""),[p,b]=g.useState(""),[m,N]=g.useState(!1),[w,A]=g.useState(null),f=n==="cash"?Math.max(0,parseFloat(c||0)-r.grandTotal):0,v=o.items.length>0&&!m&&(n!=="cash"||parseFloat(c||0)>=r.grandTotal);async function O(d){var y,C,P,T;N(!0);try{const h={type:o.orderType,table_id:o.tableId??void 0,customer_name:o.customerName||void 0,customer_phone:o.customerPhone||void 0,notes:o.notes||void 0,items:o.items.map(_=>({menu_item_id:_.menu_item_id,qty:_.qty,special_instructions:_.special_instructions||void 0})),voucher_code:o.voucherCode||void 0,payment_method:n,payment_status:d,transaction_id:p||void 0},S=(y=(await ee.createOrder(h)).data)==null?void 0:y.data,q=await te.invoice(S.order_number);A(((C=q.data)==null?void 0:C.data)??{order:S,restaurant:null}),k.success("Order created!")}catch(h){const I=((T=(P=h.response)==null?void 0:P.data)==null?void 0:T.message)??"Failed to create order";k.error(I),N(!1)}}function j(){A(null),t()}return w?e.jsx(fe,{order:w.order,restaurant:w.restaurant,onClose:j}):e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-md",onClick:d=>d.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Collect Payment"}),e.jsx("button",{onClick:a,className:"text-gray-400 hover:text-gray-600",children:e.jsx(Y,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"p-6 space-y-5",children:[e.jsxs("div",{className:"text-center py-3 bg-gray-50 rounded-xl",children:[e.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Total Amount Due"}),e.jsxs("p",{className:"text-4xl font-bold text-gray-900",children:["à§³",r.grandTotal.toFixed(2)]}),r.discount>0&&e.jsxs("p",{className:"text-sm text-green-600 mt-1",children:["Voucher discount: -à§³",r.discount.toFixed(2)]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 mb-2",children:"Payment Method"}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:je.map(d=>{const y=Ne[d.color],C=n===d.id;return e.jsxs("button",{onClick:()=>{l(d.id),i(""),b("")},className:`flex flex-col items-center justify-center gap-1.5 py-3 px-2 rounded-xl border-2 transition-all text-center ${C?`${y.bg} ${y.ring} ring-2 border-transparent ${y.text}`:"border-gray-200 text-gray-500 hover:border-gray-300"}`,children:[e.jsx(d.icon,{className:`w-6 h-6 ${C?y.icon:"text-gray-400"}`}),e.jsx("span",{className:"text-xs font-medium leading-tight",children:d.label})]},d.id)})})]}),n==="cash"&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tendered Amount (à§³)"}),e.jsx("input",{type:"number",min:r.grandTotal,step:"0.01",value:c,onChange:d=>i(d.target.value),placeholder:`Min à§³${r.grandTotal.toFixed(2)}`,className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-lg font-semibold focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none",autoFocus:!0})]}),parseFloat(c||0)>0&&e.jsxs("div",{className:`flex justify-between items-center px-4 py-2.5 rounded-lg ${f>0?"bg-green-50 text-green-700":"bg-red-50 text-red-600"}`,children:[e.jsx("span",{className:"font-medium",children:"Change Due"}),e.jsxs("span",{className:"text-xl font-bold",children:["à§³",f.toFixed(2)]})]})]}),(n==="card"||n==="mobile_banking")&&e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[n==="card"?"Card / POS Reference No.":"bKash / Nagad Transaction ID",e.jsx("span",{className:"text-gray-400 font-normal ml-1",children:"(optional)"})]}),e.jsx("input",{type:"text",value:p,onChange:d=>b(d.target.value),placeholder:"Enter reference number...",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none",autoFocus:!0})]}),e.jsxs("div",{className:"space-y-2 pt-1",children:[e.jsxs("button",{disabled:!v,onClick:()=>O("paid"),className:"w-full flex items-center justify-center gap-2 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed text-white font-semibold py-3 rounded-xl transition-colors",children:[m?e.jsxs("svg",{className:"animate-spin w-5 h-5",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v8H4z"})]}):e.jsx(ce,{className:"w-5 h-5"}),"Mark as Paid & Print Receipt"]}),e.jsx("button",{disabled:m||o.items.length===0,onClick:()=>O("pending"),className:"w-full text-sm text-gray-500 hover:text-gray-700 py-2 disabled:opacity-40 disabled:cursor-not-allowed transition-colors",children:"Place Order â€” Pay Later"})]})]})]})})}const Ce=[{id:"dine",label:"Dine-In",icon:ue},{id:"parcel",label:"Takeaway",icon:U},{id:"quick",label:"Quick Sale",icon:xe}];function _e({carts:o,activeCartId:r,onSelect:t,onCreate:a,onDelete:n}){var c;const l=r??((c=o[0])==null?void 0:c.id);return e.jsxs("div",{className:"flex items-center gap-1 overflow-x-auto pb-1 min-h-[38px]",children:[o.map(i=>{const p=i.id===l,b=i.items.reduce((m,N)=>m+N.price*N.qty,0);return e.jsxs("div",{onClick:()=>t(i.id),className:`flex items-center gap-1.5 px-3 py-1.5 rounded-lg text-sm font-medium cursor-pointer whitespace-nowrap select-none transition-colors ${p?"bg-blue-600 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:[e.jsx("span",{children:i.label}),b>0&&e.jsxs("span",{className:`text-xs ${p?"text-blue-200":"text-gray-400"}`,children:["à§³",b.toFixed(0)]}),o.length>1&&e.jsx("button",{onClick:m=>{m.stopPropagation(),n(i.id)},className:`ml-0.5 rounded hover:bg-white/20 p-0.5 ${p?"text-blue-200 hover:text-white":"text-gray-400 hover:text-red-500"}`,children:e.jsx(Y,{className:"w-3 h-3"})})]},i.id)}),o.length<5&&e.jsxs("button",{onClick:a,className:"flex items-center gap-1 px-2.5 py-1.5 rounded-lg text-sm text-gray-500 hover:bg-gray-100 border border-dashed border-gray-300 whitespace-nowrap",children:[e.jsx(be,{className:"w-3.5 h-3.5"}),"New"]})]})}function Oe(){var _,H,$,V,D,E,R,X,L,z,B,K;const{user:o}=se(),r=ve(),t=r.getActiveCart(),[a,n]=g.useState(""),[l,c]=g.useState(null),[i,p]=g.useState((t==null?void 0:t.voucherCode)??""),[b,m]=g.useState(!1),[N,w]=g.useState(!1),A=parseFloat(((_=o==null?void 0:o.tenant)==null?void 0:_.tax_rate)??0),{data:f}=M({queryKey:["pos-categories"],queryFn:()=>ae.list({per_page:100}),staleTime:3e4}),{data:v,refetch:O}=M({queryKey:["pos-menu"],queryFn:()=>ne.list({per_page:200}),staleTime:3e4}),{data:j,refetch:d}=M({queryKey:["pos-tables"],queryFn:()=>le.list({per_page:100}),staleTime:1e4}),y=(($=(H=f==null?void 0:f.data)==null?void 0:H.data)==null?void 0:$.data)??((V=f==null?void 0:f.data)==null?void 0:V.data)??[],C=((E=(D=v==null?void 0:v.data)==null?void 0:D.data)==null?void 0:E.data)??((R=v==null?void 0:v.data)==null?void 0:R.data)??[],P=((L=(X=j==null?void 0:j.data)==null?void 0:X.data)==null?void 0:L.data)??((z=j==null?void 0:j.data)==null?void 0:z.data)??[],T=C.filter(s=>!s.is_active||l&&s.category_id!==l?!1:a?s.name.toLowerCase().includes(a.toLowerCase()):!0);g.useEffect(()=>{p((t==null?void 0:t.voucherCode)??"")},[t==null?void 0:t.id]);const h=r.getCartTotals(A);async function I(){var s;if(i.trim()){m(!0);try{const u=(s=(await re.validate({code:i.trim(),subtotal:h.subtotal})).data)==null?void 0:s.data;r.setVoucher(i.trim(),(u==null?void 0:u.discount)??0,(u==null?void 0:u.voucher_id)??null),k.success(`Voucher applied! -à§³${((u==null?void 0:u.discount)??0).toFixed(2)}`)}catch{k.error("Invalid or expired voucher code"),r.clearVoucher()}finally{m(!1)}}}function S(){r.clearVoucher(),p("")}function q(){w(!1),r.clearActiveCart(),d(),k.success("Cart cleared â€” ready for next order")}return t?e.jsxs("div",{className:"flex h-[calc(100vh-64px)] bg-gray-100 overflow-hidden",children:[e.jsxs("div",{className:"flex flex-col w-[58%] bg-white border-r border-gray-200 overflow-hidden",children:[e.jsxs("div",{className:"px-4 pt-4 pb-3 border-b border-gray-100 space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-base font-semibold text-gray-800",children:"POS Terminal"}),e.jsx("button",{onClick:()=>{O(),d()},className:"text-gray-400 hover:text-blue-500 p-1 rounded",title:"Refresh menu & tables",children:e.jsx(de,{className:"w-4 h-4"})})]}),e.jsx(_e,{carts:r.carts,activeCartId:r.activeCartId,onSelect:r.setActiveCart.bind(r),onCreate:r.createCart.bind(r),onDelete:s=>{var u;const x=r.carts.find(W=>W.id===s);((u=x==null?void 0:x.items)==null?void 0:u.length)>0&&!window.confirm("Delete this order cart?")||r.deleteCart(s)}}),e.jsxs("div",{className:"relative",children:[e.jsx(Q,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx("input",{value:a,onChange:s=>n(s.target.value),placeholder:"Search menu itemsâ€¦",className:"w-full pl-9 pr-4 py-2 text-sm border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none"})]})]}),e.jsxs("div",{className:"flex gap-2 px-4 py-2 overflow-x-auto border-b border-gray-100 shrink-0",children:[e.jsx("button",{onClick:()=>c(null),className:`px-3 py-1.5 rounded-full text-xs font-medium whitespace-nowrap transition-colors ${l===null?"bg-blue-600 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:"All"}),y.map(s=>e.jsx("button",{onClick:()=>c(s.id),className:`px-3 py-1.5 rounded-full text-xs font-medium whitespace-nowrap transition-colors ${l===s.id?"bg-blue-600 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:s.name},s.id))]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-3",children:T.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-40 text-gray-400",children:[e.jsx(Q,{className:"w-8 h-8 mb-2"}),e.jsx("p",{className:"text-sm",children:"No items found"})]}):e.jsx("div",{className:"grid grid-cols-3 xl:grid-cols-4 gap-2.5",children:T.map(s=>{const x=t.items.find(u=>u.menu_item_id===s.id);return e.jsxs("button",{onClick:()=>r.addItem(s),className:`relative flex flex-col rounded-xl border text-left transition-all hover:shadow-md active:scale-[0.97] overflow-hidden ${x?"border-blue-400 ring-2 ring-blue-100":"border-gray-200 hover:border-blue-300"}`,children:[e.jsx("div",{className:"h-24 bg-gray-100 overflow-hidden",children:s.image_url?e.jsx("img",{src:s.image_url,alt:s.name,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-300 text-2xl",children:"ðŸ½"})}),e.jsxs("div",{className:"p-2 flex-1 flex flex-col",children:[e.jsx("p",{className:"text-xs font-semibold text-gray-800 leading-tight line-clamp-2",children:s.name}),e.jsxs("p",{className:"text-sm font-bold text-blue-600 mt-auto pt-1",children:["à§³",parseFloat(s.price).toFixed(2)]})]}),x&&e.jsx("div",{className:"absolute top-1.5 right-1.5 bg-blue-600 text-white text-xs font-bold rounded-full w-5 h-5 flex items-center justify-center",children:x.qty})]},s.id)})})})]}),e.jsxs("div",{className:"flex flex-col w-[42%] bg-white overflow-hidden",children:[e.jsxs("div",{className:"px-4 pt-4 pb-3 border-b border-gray-100 space-y-3",children:[e.jsx("div",{className:"flex bg-gray-100 rounded-xl p-1 gap-1",children:Ce.map(s=>{const x=t.orderType===s.id;return e.jsxs("button",{onClick:()=>r.setOrderType(s.id),className:`flex-1 flex items-center justify-center gap-1.5 py-2 rounded-lg text-xs font-semibold transition-all ${x?"bg-white text-blue-700 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:[e.jsx(s.icon,{className:"w-3.5 h-3.5"}),s.label]},s.id)})}),t.orderType==="dine"&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 mb-2",children:"Select Table"}),e.jsx("div",{className:"grid grid-cols-4 gap-1.5 max-h-28 overflow-y-auto",children:P.filter(s=>s.status!=="inactive").map(s=>{const x=t.tableId===s.id,u=s.status==="occupied";return e.jsxs("button",{onClick:()=>r.setTable(s.id,s.table_number),className:`py-2 rounded-lg text-xs font-semibold border transition-all ${x?"bg-blue-600 text-white border-blue-600":u?"bg-orange-50 text-orange-600 border-orange-200 hover:border-orange-400":"bg-green-50 text-green-700 border-green-200 hover:border-green-400"}`,children:["T",s.table_number,u&&!x&&e.jsx("span",{className:"block text-[9px] leading-none text-orange-400",children:"busy"})]},s.id)})}),t.tableId&&e.jsxs("p",{className:"mt-1 text-xs text-blue-600 font-medium",children:["âœ“ Table ",t.tableName," selected"]})]}),t.orderType==="parcel"&&e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1 font-medium",children:"Customer Name *"}),e.jsx("input",{value:t.customerName,onChange:s=>r.setCustomer(s.target.value,t.customerPhone),placeholder:"Name",className:"w-full border border-gray-200 rounded-lg px-2.5 py-1.5 text-sm focus:ring-2 focus:ring-blue-500 outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1 font-medium",children:"Phone"}),e.jsx("input",{value:t.customerPhone,onChange:s=>r.setCustomer(t.customerName,s.target.value),placeholder:"01XXXXXXXXX",className:"w-full border border-gray-200 rounded-lg px-2.5 py-1.5 text-sm focus:ring-2 focus:ring-blue-500 outline-none"})]})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto px-4 py-2 space-y-1.5",children:t.items.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-32 text-gray-300",children:[e.jsx(U,{className:"w-10 h-10 mb-2"}),e.jsx("p",{className:"text-sm font-medium",children:"Cart is empty"}),e.jsx("p",{className:"text-xs",children:"Tap items on the left to add"})]}):t.items.map(s=>e.jsxs("div",{className:"p-2.5 rounded-xl bg-gray-50 border border-gray-100",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-semibold text-gray-800 truncate",children:s.name}),e.jsxs("p",{className:"text-xs text-gray-500",children:["à§³",s.price.toFixed(2)," each"]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>r.updateQty(s.menu_item_id,s.qty-1),className:"w-6 h-6 rounded-full bg-gray-200 hover:bg-red-100 hover:text-red-600 flex items-center justify-center transition-colors",children:e.jsx(me,{className:"w-4 h-4"})}),e.jsx("span",{className:"w-7 text-center text-sm font-bold",children:s.qty}),e.jsx("button",{onClick:()=>r.updateQty(s.menu_item_id,s.qty+1),className:"w-6 h-6 rounded-full bg-gray-200 hover:bg-green-100 hover:text-green-600 flex items-center justify-center transition-colors",children:e.jsx(he,{className:"w-4 h-4"})})]}),e.jsxs("p",{className:"text-sm font-bold text-gray-800 w-16 text-right",children:["à§³",(s.price*s.qty).toFixed(2)]}),e.jsx("button",{onClick:()=>r.removeItem(s.menu_item_id),className:"text-gray-300 hover:text-red-500 transition-colors",children:e.jsx(pe,{className:"w-4 h-4"})})]}),e.jsx("div",{className:"mt-1.5",children:e.jsx("input",{value:s.special_instructions??"",onChange:x=>r.updateInstructions(s.menu_item_id,x.target.value),placeholder:"Special instructionsâ€¦",className:"w-full text-[11px] text-gray-500 bg-transparent border-0 border-b border-dashed border-gray-200 focus:border-blue-400 px-0 py-0.5 outline-none placeholder:text-gray-300"})})]},s.menu_item_id))}),e.jsxs("div",{className:"border-t border-gray-100 px-4 py-3 space-y-3",children:[e.jsx("input",{value:t.notes,onChange:s=>r.setNotes(s.target.value),placeholder:"Order notes (optional)â€¦",className:"w-full text-xs border border-gray-200 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 outline-none resize-none"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(ge,{className:"absolute left-2.5 top-1/2 -translate-y-1/2 text-gray-400 w-3.5 h-3.5"}),e.jsx("input",{value:i,onChange:s=>p(s.target.value),onKeyDown:s=>s.key==="Enter"&&I(),placeholder:"Voucher code",disabled:!!t.voucherCode,className:"w-full pl-8 pr-3 py-1.5 text-xs border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none disabled:bg-gray-50 disabled:text-gray-400"})]}),t.voucherCode?e.jsx("button",{onClick:S,className:"px-3 py-1.5 text-xs text-red-600 border border-red-200 rounded-lg hover:bg-red-50",children:"Remove"}):e.jsx("button",{onClick:I,disabled:!i.trim()||b,className:"px-3 py-1.5 text-xs bg-gray-800 text-white rounded-lg hover:bg-gray-700 disabled:bg-gray-300 disabled:cursor-not-allowed",children:b?"â€¦":"Apply"})]}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("div",{className:"flex justify-between text-gray-500",children:[e.jsx("span",{children:"Subtotal"}),e.jsxs("span",{children:["à§³",h.subtotal.toFixed(2)]})]}),h.discount>0&&e.jsxs("div",{className:"flex justify-between text-green-600",children:[e.jsx("span",{children:"Voucher Discount"}),e.jsxs("span",{children:["-à§³",h.discount.toFixed(2)]})]}),h.tax>0&&e.jsxs("div",{className:"flex justify-between text-gray-500",children:[e.jsx("span",{children:"Tax"}),e.jsxs("span",{children:["à§³",h.tax.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between font-bold text-gray-900 text-base pt-1 border-t border-gray-200",children:[e.jsx("span",{children:"Grand Total"}),e.jsxs("span",{children:["à§³",h.grandTotal.toFixed(2)]})]})]}),e.jsxs("button",{disabled:t.items.length===0||t.orderType==="dine"&&!t.tableId||t.orderType==="parcel"&&!((B=t.customerName)!=null&&B.trim()),onClick:()=>w(!0),className:"w-full flex items-center justify-center gap-2 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed text-white font-bold py-3 rounded-xl transition-colors text-sm",children:[e.jsx(G,{className:"w-5 h-5"}),"Collect Payment â€” à§³",h.grandTotal.toFixed(2)]}),t.orderType==="dine"&&!t.tableId&&t.items.length>0&&e.jsx("p",{className:"text-xs text-center text-amber-600",children:"Please select a table to proceed"}),t.orderType==="parcel"&&!((K=t.customerName)!=null&&K.trim())&&t.items.length>0&&e.jsx("p",{className:"text-xs text-center text-amber-600",children:"Customer name is required for takeaway"})]})]}),N&&e.jsx(we,{cart:t,totals:h,onSuccess:q,onClose:()=>w(!1)})]}):null}export{Oe as default};
