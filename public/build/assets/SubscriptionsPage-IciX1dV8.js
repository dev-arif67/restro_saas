import{i as b,r as c,j as e,L as N,z as d,y as m}from"./index-B_U3xfNL.js";import{u as y}from"./useQuery-CITVF-0B.js";import{u as f}from"./useMutation-CUUa5Gsz.js";import{S as o}from"./StatusBadge-DyZgxZz-.js";import{M as g}from"./Modal-4G-2S5vy.js";function C(){const u=b(),[x,n]=c.useState(!1),[l,p]=c.useState(null),{data:a,isLoading:h}=y({queryKey:["admin-subscriptions"],queryFn:()=>m.subscriptions.list().then(s=>s.data.data)}),r=f({mutationFn:s=>m.subscriptions.create(s),onSuccess:()=>{u.invalidateQueries(["admin-subscriptions"]),n(!1),d.success("Subscription created")},onError:s=>{var t,i;return d.error(((i=(t=s.response)==null?void 0:t.data)==null?void 0:i.message)||"Error")}}),j=s=>{s.preventDefault();const t=Object.fromEntries(new FormData(s.target));t.tenant_id=l,t.amount=parseFloat(t.amount),r.mutate(t)};return h?e.jsx(N,{}):e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-gray-800",children:"Subscriptions"}),e.jsx("button",{onClick:()=>n(!0),className:"btn-primary text-sm sm:text-base",children:"+ Add Subscription"})]}),e.jsx("div",{className:"hidden md:block card overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left border-b",children:[e.jsx("th",{className:"pb-3",children:"Tenant"}),e.jsx("th",{className:"pb-3",children:"Plan"}),e.jsx("th",{className:"pb-3",children:"Amount"}),e.jsx("th",{className:"pb-3",children:"Start"}),e.jsx("th",{className:"pb-3",children:"Expires"}),e.jsx("th",{className:"pb-3",children:"Status"})]})}),e.jsx("tbody",{children:a==null?void 0:a.map(s=>{var t;return e.jsxs("tr",{className:"border-b last:border-0",children:[e.jsx("td",{className:"py-3 font-medium",children:(t=s.tenant)==null?void 0:t.name}),e.jsx("td",{className:"py-3 capitalize",children:s.plan_type}),e.jsxs("td",{className:"py-3",children:["৳",s.amount]}),e.jsx("td",{className:"py-3",children:new Date(s.starts_at).toLocaleDateString()}),e.jsx("td",{className:"py-3",children:new Date(s.expires_at).toLocaleDateString()}),e.jsx("td",{className:"py-3",children:e.jsx(o,{status:s.status})})]},s.id)})})]})}),e.jsx("div",{className:"md:hidden space-y-3",children:a==null?void 0:a.map(s=>{var t;return e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2 mb-2",children:[e.jsx("p",{className:"font-semibold text-gray-900",children:(t=s.tenant)==null?void 0:t.name}),e.jsx(o,{status:s.status})]}),e.jsxs("div",{className:"flex items-center gap-3 text-sm text-gray-500 mb-2",children:[e.jsx("span",{className:"capitalize",children:s.plan_type}),e.jsxs("span",{className:"font-medium text-gray-900",children:["৳",s.amount]})]}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-400 pt-2 border-t",children:[e.jsxs("span",{children:["Start: ",new Date(s.starts_at).toLocaleDateString()]}),e.jsxs("span",{children:["Expires: ",new Date(s.expires_at).toLocaleDateString()]})]})]},s.id)})}),e.jsx(g,{isOpen:x,onClose:()=>n(!1),title:"Add Subscription",children:e.jsxs("form",{onSubmit:j,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Tenant ID"}),e.jsx("input",{type:"number",className:"input",value:l||"",onChange:s=>p(s.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Plan"}),e.jsxs("select",{name:"plan_type",className:"input",children:[e.jsx("option",{value:"monthly",children:"Monthly"}),e.jsx("option",{value:"yearly",children:"Yearly"}),e.jsx("option",{value:"custom",children:"Custom"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Amount"}),e.jsx("input",{name:"amount",type:"number",step:"0.01",className:"input",required:!0})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Starts"}),e.jsx("input",{name:"starts_at",type:"date",className:"input",defaultValue:new Date().toISOString().split("T")[0],required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Expires"}),e.jsx("input",{name:"expires_at",type:"date",className:"input",required:!0})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{type:"submit",className:"btn-primary",disabled:r.isPending,children:"Save"}),e.jsx("button",{type:"button",onClick:()=>n(!1),className:"btn-secondary",children:"Cancel"})]})]})})]})}export{C as default};
